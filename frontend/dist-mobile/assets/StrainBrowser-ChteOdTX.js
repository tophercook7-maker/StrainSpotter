import{r as a,j as e,B as c,I as H,y as as,T as o,C as ns,S as h,P as v,a0 as u,m as is,aR as je,ai as ve,aS as Se,ae as ye,af as we,ag as Ce,ah as S,i as y,aT as ls,ak as cs,Q as ds,H as z,aU as Ie,aV as ke,n as ze,D as hs,p as xs,a5 as fs,aW as gs,q as us,k as ps,l as U,as as bs,A as Ae,aI as Fe,aJ as _e,aX as Te,a8 as ms,aK as Le,aj as js,aY as We,V as Re,L as vs}from"./react-vendor-CxfKVgr3.js";import{s as A,a as E}from"./App-JmJcCWdD.js";import{S as Ss}from"./SeedVendorFinder-tPICLvgV.js";import{J as ys}from"./JournalDialog-D1DsrI9a.js";import{E as ws}from"./EmptyStateCard-sMvJRayT.js";import{u as Cs}from"./useStrainImage-pCt_md2M.js";import"./vendor-DCH4KwNm.js";import"./BackHeader-jnSvreF0.js";const D=100,Oe=1e3,Is=x=>x&&[x.thumbnail_url,x.image_url,x.photo_url,x.main_image,x.leafly_image,x.hero_image_url,x.image,x.imageUrl].find(w=>typeof w=="string"&&w.startsWith("http"))||null;function ks({strain:x}){const m=x?.name||x?.canonicalName||null,{imageUrl:w}=Cs(m),f=Is(x),F=w||f;return e.jsxs(e.Fragment,{children:[F?e.jsx(c,{component:"img",src:F,alt:x?.name||"Strain photo",loading:"lazy",sx:{width:"100%",height:"100%",objectFit:"cover",display:"block",background:"#111"},onError:g=>{g.currentTarget.style.display="none";const _=g.currentTarget.parentElement?.querySelector(".strain-placeholder");_&&(_.style.display="flex")}}):null,e.jsx(c,{className:"strain-placeholder",sx:{display:F?"none":"flex",alignItems:"center",justifyContent:"center",width:"100%",height:"100%",position:"absolute",top:0,left:0,background:"linear-gradient(135deg, rgba(124, 179, 66, 0.15) 0%, rgba(0, 0, 0, 0.4) 100%)",border:"1px solid rgba(124, 179, 66, 0.2)"},children:e.jsx(o,{variant:"caption",sx:{color:"rgba(200, 230, 201, 0.6)",fontSize:11,textAlign:"center",px:2,fontWeight:500},children:"No strain photo yet"})})]})}function Os({onBack:x}){const[m,w]=a.useState([]),[f,F]=a.useState([]),[g,_]=a.useState([]),[W,te]=a.useState(!0),[R,V]=a.useState(""),[M,oe]=a.useState("all"),[d,Ee]=a.useState(null),[De,T]=a.useState(!1),[ae,ne]=a.useState(0),[J,ie]=a.useState([]),[q,G]=a.useState([]),[Q,K]=a.useState([]),[L,X]=a.useState(null),[Me,Y]=a.useState(!0),[le,ce]=a.useState(0),[$,B]=a.useState(!0),[$e,Be]=a.useState(!1),[Z,Pe]=a.useState("type"),[p,Ne]=a.useState([0,35]),[b,de]=a.useState([]),[j,He]=a.useState(!1),[O,C]=a.useState({open:!1,message:"",severity:"success"}),[Ue,he]=a.useState(!1),[Ve,ee]=a.useState(!1),[Je,se]=a.useState(!1),[qe,Ge]=a.useState(null),[re,xe]=a.useState(300),fe=a.useRef(null),Qe=s=>{s&&(Ge({strain_name:s.name,strain_slug:s.slug}),se(!0))};a.useEffect(()=>{navigator.geolocation?navigator.geolocation.getCurrentPosition(s=>{console.log("[StrainBrowser] Location obtained successfully"),X({lat:s.coords.latitude,lng:s.coords.longitude}),Y(!1)},s=>{console.log("[StrainBrowser] Location denied or unavailable:",s.message),X({lat:37.7749,lng:-122.4194}),Y(!1)},{timeout:5e3,maximumAge:3e5,enableHighAccuracy:!1}):(console.log("[StrainBrowser] Geolocation not supported"),X({lat:37.7749,lng:-122.4194}),Y(!1))},[]);const ge=a.useCallback(async()=>{if(!A)return[];let s=[],r=0;const i=Oe;let t=!0;for(;t;){const n=r+i-1,{data:l,error:I,count:k}=await A.from("strains").select("*",{count:"exact"}).order("name").range(r,n);if(I)throw I;l&&l.length>0?(s=[...s,...l],k&&s.length<k?r+=i:t=!1):t=!1}return s},[A]),ue=a.useCallback(async()=>{let s=[],r=1,i=1;for(;r<=i;){const t=await fetch(`${E}/api/strains?page=${r}&limit=${Oe}`);if(!t.ok)throw new Error(`HTTP ${t.status} when fetching strains from API`);const n=await t.json(),l=Array.isArray(n?.strains)?n.strains:[];if(s=[...s,...l],i=n?.pages||1,l.length===0)break;r+=1}return s},[E]),pe=a.useCallback(async()=>{try{te(!0),console.log("ðŸ” Fetching ALL strains from database...");let s=[],r=!1;if(A)try{s=await ge(),r=s.length>0,r?console.log(`âœ… Loaded ${s.length} total strains from Supabase!`):console.warn("Supabase returned 0 strains, attempting API fallback...")}catch(i){console.error("âŒ Supabase error fetching strains:",i)}if(s.length||(console.log("ðŸŒ Falling back to local API for strain data..."),s=await ue(),console.log(`âœ… Loaded ${s.length} strains via API fallback`)),!s.length)throw new Error("No strain data returned from Supabase or API");w(s),Be(!0),B(!1)}catch(s){console.error("âŒ Error fetching strains:",s),w([])}finally{te(!1)}},[ue,ge,A]);a.useEffect(()=>{pe()},[pe]);const be=a.useCallback(s=>{const r=[...s],i={indica:1,sativa:2,hybrid:3};switch(Z){case"type":return r.sort((t,n)=>{const l=(t.type||"unknown").toLowerCase(),I=(n.type||"unknown").toLowerCase(),k=i[l]||4,N=i[I]||4;return k!==N?k-N:(t.name||"").localeCompare(n.name||"")});case"name":return r.sort((t,n)=>(t.name||"").localeCompare(n.name||""));case"thc":return r.sort((t,n)=>(parseFloat(n.thc)||0)-(parseFloat(t.thc)||0));case"rating":return r.sort((t,n)=>(t.name||"").localeCompare(n.name||""));default:return r}},[Z]),me=a.useCallback(s=>s.filter(r=>{const i=parseFloat(r.thc)||0;return i>=p[0]&&i<=p[1]}),[p]),P=a.useCallback(()=>{ee(!1);let s=[...m];if(R){const r=R.toLowerCase();s=s.filter(i=>i.name?.toLowerCase().includes(r)||i.description?.toLowerCase().includes(r)||i.effects?.some(t=>t.toLowerCase().includes(r))||i.flavors?.some(t=>t.toLowerCase().includes(r)))}M!=="all"&&(s=s.filter(r=>r.type?.toLowerCase()===M)),j?s=me(s):s=s.filter(r=>{const i=r.thc??0;return i>=p[0]&&i<=p[1]}),s=be(s),F(s)},[m,R,M,j,p,be,me]);a.useEffect(()=>{P()},[P]);const Ke=a.useMemo(()=>Array.isArray(g)?g.slice(0,re):[],[g,re]);a.useEffect(()=>{_(f.slice(0,D)),ce(0),B(f.length>D),xe(300)},[f]),a.useEffect(()=>{const s=()=>{const t=le+1,n=t*D,l=n+D,I=f.slice(n,l);I.length>0&&(_(N=>[...N,...I]),ce(t));const k=l<f.length;B(k)},r=fe.current,i=new IntersectionObserver(t=>{t[0].isIntersecting&&$&&!W&&s()},{threshold:.1});return r&&i.observe(r),()=>{r&&i.unobserve(r)}},[$,W,le,f]);const Xe=async s=>{Ee(s),T(!0),ne(0),Ye(s.name),Ze(),es(s.slug,s)},Ye=async s=>{try{const n=((await(await fetch(`${E||"http://localhost:5181"}/api/seeds-live?strain=${encodeURIComponent(s)}&limit=20`)).json()).results||[]).map(l=>({seed_vendors:{name:l.name,website:l.website,country:l.country,rating:l.rating||0,verified:l.verified||!1},price:l.price||"N/A",seed_count:l.seed_count||10,url:l.website,in_stock:l.in_stock!==!1}));ie(n)}catch(r){console.error("Error fetching vendors:",r),ie([])}},Ze=async()=>{try{if(!L){G([]);return}const t=((await(await fetch(`${E||"http://localhost:5181"}/api/dispensaries-live?lat=${L.lat}&lng=${L.lng}&radius=100&limit=20`)).json()).results||[]).map(n=>({dispensaries:{name:n.name,city:n.city||n.address?.split(",")[1]?.trim()||"Unknown",state:n.state||n.address?.split(",")[2]?.trim()||"",rating:n.rating||0,verified:n.verified||!1,website:n.website||null},price_per_eighth:n.price_per_eighth||"N/A",price_per_ounce:n.price_per_ounce||"N/A",distance:n.distance,in_stock:!0}));G(t)}catch(s){console.error("Error fetching dispensaries:",s),G([])}},es=async(s,r)=>{try{if(A){const{data:t,error:n}=await A.from("reviews").select("*").eq("strain_slug",s).order("created_at",{ascending:!1}).limit(10);if(n)throw n;if(t&&t.length){K(t);return}}const i=await fetch(`${E}/api/strains/${s}/reviews`);if(i.ok){const t=await i.json().catch(()=>({})),n=Array.isArray(t?.reviews)?t.reviews:[];K(n);return}throw new Error(`HTTP ${i.status} when fetching reviews`)}catch(i){console.error("Error fetching reviews:",i);const t=r?.reviews;K(Array.isArray(t)?t:[])}},ss=s=>{switch(s?.toLowerCase()){case"indica":return"#9c27b0";case"sativa":return"#ff9800";case"hybrid":return"#4caf50";default:return"#757575"}};a.useEffect(()=>{const s=localStorage.getItem("strainFavorites");if(s)try{de(JSON.parse(s))}catch(r){console.error("Error loading favorites:",r)}},[]),a.useEffect(()=>{localStorage.setItem("strainFavorites",JSON.stringify(b))},[b]);const rs=s=>{de(r=>r.includes(s)?(C({open:!0,message:"Removed from favorites",severity:"info"}),r.filter(t=>t!==s)):(C({open:!0,message:"Added to favorites! â­",severity:"success"}),[...r,s]))},ts=()=>{if(!d)return null;switch(ae){case 0:return e.jsxs(c,{children:[e.jsx(o,{variant:"body1",sx:{color:"#fff",mb:2},children:d.description||"No description available"}),d.effects&&d.effects.length>0&&e.jsxs(c,{sx:{mb:2},children:[e.jsx(o,{variant:"subtitle2",sx:{color:"#7cb342",fontWeight:700,mb:1},children:"Effects:"}),e.jsx(h,{direction:"row",spacing:1,flexWrap:"wrap",children:d.effects.map((s,r)=>e.jsx(z,{label:s,size:"small",sx:{bgcolor:"rgba(124, 179, 66, 0.3)",color:"#fff",mb:1}},r))})]}),d.flavors&&d.flavors.length>0&&e.jsxs(c,{sx:{mb:2},children:[e.jsx(o,{variant:"subtitle2",sx:{color:"#7cb342",fontWeight:700,mb:1},children:"Flavors:"}),e.jsx(h,{direction:"row",spacing:1,flexWrap:"wrap",children:d.flavors.map((s,r)=>e.jsx(z,{label:s,size:"small",sx:{bgcolor:"rgba(255, 152, 0, 0.3)",color:"#fff",mb:1}},r))})]}),e.jsxs(u,{container:!0,spacing:2,sx:{mt:2},children:[e.jsx(u,{item:!0,xs:6,sm:3,children:e.jsxs(v,{sx:{p:2,bgcolor:"rgba(124, 179, 66, 0.15)",borderRadius:2},children:[e.jsx(o,{variant:"caption",sx:{color:"#e0e0e0"},children:"Type"}),e.jsx(o,{variant:"h6",sx:{color:"#fff",textTransform:"capitalize"},children:d.type||"Unknown"})]})}),d.thc&&e.jsx(u,{item:!0,xs:6,sm:3,children:e.jsxs(v,{sx:{p:2,bgcolor:"rgba(124, 179, 66, 0.2)",borderRadius:2},children:[e.jsx(o,{variant:"caption",sx:{color:"#e0e0e0"},children:"THC"}),e.jsxs(o,{variant:"h5",sx:{color:"#7cb342",fontWeight:700},children:[d.thc,"%"]})]})}),d.cbd&&e.jsx(u,{item:!0,xs:6,sm:3,children:e.jsxs(v,{sx:{p:2,bgcolor:"rgba(33, 150, 243, 0.2)",borderRadius:2},children:[e.jsx(o,{variant:"caption",sx:{color:"#e0e0e0"},children:"CBD"}),e.jsxs(o,{variant:"h5",sx:{color:"#2196f3",fontWeight:700},children:[d.cbd,"%"]})]})}),e.jsx(u,{item:!0,xs:12,sm:d.cbd?3:6,children:e.jsxs(v,{sx:{p:2,bgcolor:"rgba(255,255,255,0.08)",borderRadius:2},children:[e.jsx(o,{variant:"caption",sx:{color:"#e0e0e0"},children:"Common effects"}),e.jsx(o,{variant:"body2",sx:{color:"#fff"},children:d.effects?.slice(0,3).join(", ")||"â€”"})]})}),e.jsx(u,{item:!0,xs:12,sm:6,children:e.jsxs(v,{sx:{p:2,bgcolor:"rgba(255,255,255,0.08)",borderRadius:2},children:[e.jsx(o,{variant:"caption",sx:{color:"#e0e0e0"},children:"Flavors"}),e.jsx(o,{variant:"body2",sx:{color:"#fff"},children:d.flavors?.slice(0,3).join(", ")||"â€”"})]})})]})]});case 1:return e.jsxs(c,{children:[e.jsx(h,{spacing:2,sx:{mb:3},children:e.jsxs(y,{variant:"contained",size:"small",startIcon:e.jsx(Se,{}),onClick:()=>{he(!0),T(!1)},sx:{bgcolor:"rgba(124, 179, 66, 0.3)",color:"#fff",border:"1px solid rgba(124, 179, 66, 0.6)",backdropFilter:"blur(10px)","&:hover":{bgcolor:"rgba(124, 179, 66, 0.5)",border:"1px solid rgba(124, 179, 66, 0.8)"}},children:["Search All Seed Banks for ",d?.name]})}),J.length===0?e.jsxs(h,{spacing:2,sx:{textAlign:"center",py:4},children:[e.jsx(o,{sx:{color:"#e0e0e0"},children:"No seed vendors found for this strain"}),e.jsx(o,{variant:"caption",sx:{color:"#aaa"},children:"Click the button above to search all seed banks"})]}):e.jsx(Fe,{children:J.map((s,r)=>e.jsxs(_e,{sx:{bgcolor:"rgba(255,255,255,0.05)",borderRadius:2,mb:2,border:"1px solid rgba(124, 179, 66, 0.3)"},children:[e.jsx(Te,{children:e.jsx(vs,{sx:{color:"#7cb342"}})}),e.jsx(Le,{primary:e.jsxs(h,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(o,{sx:{color:"#fff",fontWeight:600},children:s.seed_vendors?.name}),s.seed_vendors?.verified&&e.jsx(Re,{sx:{fontSize:16,color:"#2196f3"}})]}),secondary:e.jsxs(h,{spacing:.5,sx:{mt:1},children:[e.jsxs(o,{variant:"body2",sx:{color:"#e0e0e0"},children:[e.jsx(We,{sx:{fontSize:14,verticalAlign:"middle",mr:.5}}),"$",s.price," for ",s.seed_count," seeds"]}),e.jsxs(o,{variant:"caption",sx:{color:"#aaa"},children:[s.seed_vendors?.country," â€¢ Rating: ",s.seed_vendors?.rating,"/5"]}),s.url&&e.jsx(y,{size:"small",href:s.url,target:"_blank",sx:{mt:1,color:"#7cb342"},children:"Visit Store â†’"})]})})]},r))})]});case 2:return e.jsxs(c,{children:[e.jsx(Ae,{severity:"info",sx:{mb:2,bgcolor:"rgba(33, 150, 243, 0.1)",color:"#90caf9",border:"1px solid rgba(33, 150, 243, 0.3)"},children:e.jsxs(o,{variant:"body2",children:["Showing dispensaries within 100 miles of your location. Call ahead to confirm ",d?.name," is in stock."]})}),q.length===0?e.jsxs(h,{spacing:2,sx:{textAlign:"center",py:4},children:[e.jsx(o,{sx:{color:"#e0e0e0"},children:Me?"Detecting your location...":"No dispensaries found within 100 miles"}),L&&e.jsxs(o,{variant:"caption",sx:{color:"#aaa"},children:["Searching near: ",L.lat.toFixed(4),", ",L.lng.toFixed(4)]})]}):e.jsx(Fe,{children:q.map((s,r)=>e.jsxs(_e,{sx:{bgcolor:"rgba(255,255,255,0.05)",borderRadius:2,mb:2,border:"1px solid rgba(124, 179, 66, 0.3)"},children:[e.jsx(Te,{children:e.jsx(ms,{sx:{color:"#7cb342"}})}),e.jsx(Le,{primary:e.jsxs(h,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(o,{sx:{color:"#fff",fontWeight:600},children:s.dispensaries?.name}),s.dispensaries?.verified&&e.jsx(Re,{sx:{fontSize:16,color:"#2196f3"}})]}),secondary:e.jsxs(h,{spacing:.5,sx:{mt:1},children:[e.jsxs(o,{variant:"body2",sx:{color:"#e0e0e0"},children:[e.jsx(js,{sx:{fontSize:14,verticalAlign:"middle",mr:.5}}),s.dispensaries?.city,", ",s.dispensaries?.state,s.distance&&e.jsx(z,{label:`${s.distance.toFixed(1)} mi`,size:"small",sx:{ml:1,height:18,fontSize:"0.65rem",bgcolor:"rgba(124, 179, 66, 0.2)",color:"#7cb342"}})]}),e.jsxs(o,{variant:"body2",sx:{color:"#e0e0e0"},children:[e.jsx(We,{sx:{fontSize:14,verticalAlign:"middle",mr:.5}}),s.price_per_eighth!=="N/A"?`$${s.price_per_eighth}/eighth`:"Price varies",s.price_per_ounce!=="N/A"&&` â€¢ $${s.price_per_ounce}/oz`]}),e.jsxs(o,{variant:"caption",sx:{color:"#aaa"},children:["Rating: ",s.dispensaries?.rating,"/5"]}),s.dispensaries?.website&&e.jsx(y,{size:"small",href:s.dispensaries.website,target:"_blank",sx:{mt:1,color:"#7cb342"},children:"Visit Website â†’"})]})})]},r))})]});case 3:return e.jsx(c,{children:Q.length===0?e.jsx(o,{sx:{color:"#e0e0e0",textAlign:"center",py:4},children:"No reviews yet for this strain"}):e.jsx(h,{spacing:2,children:Q.map(s=>e.jsxs(v,{sx:{p:2,bgcolor:"rgba(255,255,255,0.05)",border:"1px solid rgba(124, 179, 66, 0.3)",borderRadius:2},children:[e.jsxs(h,{direction:"row",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsxs(o,{variant:"subtitle2",sx:{color:"#7cb342",fontWeight:600},children:["Rating: ",s.rating,"/5"]}),e.jsx(o,{variant:"caption",sx:{color:"#aaa"},children:new Date(s.created_at).toLocaleDateString()})]}),e.jsx(o,{variant:"body2",sx:{color:"#fff"},children:s.comment})]},s.id))})});default:return null}};if(Ue)return e.jsx(Ss,{onBack:()=>{he(!1),T(!0)}});const os=()=>{x?x():window.history.length>1&&window.history.back()};return e.jsxs(c,{sx:{height:"100vh",display:"flex",flexDirection:"column",overflow:"hidden",pt:"env(safe-area-inset-top)"},children:[e.jsxs(c,{sx:{flexShrink:0,display:"flex",alignItems:"center",p:2,gap:1.5,borderBottom:"1px solid rgba(255,255,255,0.08)",bgcolor:"transparent",backdropFilter:"blur(10px)",zIndex:1},children:[e.jsx(H,{edge:"start",onClick:os,sx:{color:"#fff"},children:e.jsx(as,{})}),e.jsx(o,{variant:"h6",sx:{fontWeight:600,color:"#fff",flex:1},children:"Strain Browser"})]}),e.jsx(c,{sx:{flex:1,minHeight:0,overflowY:"auto",WebkitOverflowScrolling:"touch"},children:e.jsxs(ns,{maxWidth:"md",sx:{py:2},children:[e.jsx(c,{sx:{display:"flex",justifyContent:"center",mb:3},children:e.jsx(c,{sx:{width:{xs:80,sm:100},height:{xs:80,sm:100},borderRadius:"50%",background:"transparent",border:"2px solid rgba(124, 179, 66, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 0 30px rgba(124, 179, 66, 0.5)",overflow:"hidden",animation:"pulse 3s ease-in-out infinite","@keyframes pulse":{"0%":{boxShadow:"0 0 20px rgba(124, 179, 66, 0.4)"},"50%":{boxShadow:"0 0 40px rgba(124, 179, 66, 0.7)"},"100%":{boxShadow:"0 0 20px rgba(124, 179, 66, 0.4)"}}},children:e.jsx("img",{src:"/hero.png?v=13",alt:"StrainSpotter",style:{width:"100%",height:"100%",objectFit:"cover"}})})}),e.jsxs(h,{direction:"row",alignItems:"center",justifyContent:"center",spacing:1,sx:{mb:2},children:[e.jsx(c,{component:"img",src:"/hero.png?v=13",alt:"",sx:{width:24,height:24,borderRadius:"50%",filter:"drop-shadow(0 0 4px rgba(124, 179, 66, 0.6))"}}),e.jsx(o,{variant:"h5",sx:{color:"#fff",fontWeight:700},children:"Strain Browser"})]}),e.jsxs(v,{sx:{p:2,mb:2,background:"rgba(255,255,255,0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(124, 179, 66, 0.3)",borderRadius:2},children:[e.jsxs(u,{container:!0,spacing:1.5,children:[e.jsx(u,{item:!0,xs:12,md:6,children:e.jsx(is,{fullWidth:!0,size:"small",placeholder:"Search strains by name, effects, flavors...",value:R,onChange:s=>V(s.target.value),onKeyPress:s=>{s.key==="Enter"&&P()},slotProps:{input:{startAdornment:e.jsx(je,{position:"start",children:e.jsx(Se,{sx:{color:"#7cb342",fontSize:20}})}),endAdornment:R&&e.jsx(je,{position:"end",children:e.jsx(H,{size:"small",onClick:()=>V(""),sx:{color:"#fff",padding:"4px"},children:e.jsx(ve,{sx:{fontSize:18}})})}),sx:{color:"#fff",fontSize:"0.875rem","& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(124, 179, 66, 0.5)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(124, 179, 66, 0.8)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#7cb342"}}}}})}),e.jsx(u,{item:!0,xs:6,sm:4,md:2,children:e.jsxs(ye,{fullWidth:!0,size:"small",children:[e.jsx(we,{sx:{color:"#fff",fontSize:"0.875rem"},children:"Type"}),e.jsxs(Ce,{value:M,onChange:s=>oe(s.target.value),label:"Type",sx:{color:"#fff",fontSize:"0.875rem","& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(124, 179, 66, 0.5)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(124, 179, 66, 0.8)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#7cb342"}},children:[e.jsx(S,{value:"all",children:"All"}),e.jsx(S,{value:"indica",children:"Indica"}),e.jsx(S,{value:"sativa",children:"Sativa"}),e.jsx(S,{value:"hybrid",children:"Hybrid"})]})]})}),e.jsx(u,{item:!0,xs:6,sm:4,md:2,children:e.jsxs(ye,{fullWidth:!0,size:"small",children:[e.jsx(we,{sx:{color:"#fff",fontSize:"0.875rem"},children:"Sort"}),e.jsxs(Ce,{value:Z,onChange:s=>Pe(s.target.value),label:"Sort",sx:{color:"#fff",fontSize:"0.875rem","& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(124, 179, 66, 0.5)"},"&:hover .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(124, 179, 66, 0.8)"},"&.Mui-focused .MuiOutlinedInput-notchedOutline":{borderColor:"#7cb342"}},children:[e.jsx(S,{value:"type",children:"Type (Iâ†’Sâ†’H)"}),e.jsx(S,{value:"name",children:"Name"}),e.jsx(S,{value:"thc",children:"THC %"}),e.jsx(S,{value:"rating",children:"Rating"})]})]})}),e.jsx(u,{item:!0,xs:12,sm:4,md:2,children:e.jsx(y,{fullWidth:!0,size:"small",variant:j?"contained":"outlined",onClick:()=>He(!j),startIcon:e.jsx(ls,{fontSize:"small"}),sx:{color:j?"#000":"#fff",bgcolor:j?"#7cb342":"transparent",borderColor:"rgba(124, 179, 66, 0.6)",fontSize:"0.875rem","&:hover":{borderColor:"rgba(124, 179, 66, 1)",bgcolor:j?"#7cb342":"rgba(124, 179, 66, 0.1)"}},children:"Filters"})})]}),j&&e.jsxs(c,{sx:{mt:3,p:2,background:"rgba(124, 179, 66, 0.1)",borderRadius:2,border:"1px solid rgba(124, 179, 66, 0.3)"},children:[e.jsx(o,{variant:"subtitle2",sx:{color:"#7cb342",fontWeight:700,mb:2},children:"Advanced Filters"}),e.jsxs(c,{sx:{px:2},children:[e.jsxs(o,{variant:"body2",sx:{color:"#fff",mb:1},children:["THC Range: ",p[0],"% - ",p[1],"%"]}),e.jsx(cs,{value:p,onChange:(s,r)=>Ne(r),valueLabelDisplay:"auto",min:0,max:35,sx:{color:"#7cb342","& .MuiSlider-thumb":{bgcolor:"#7cb342"},"& .MuiSlider-track":{bgcolor:"#7cb342"},"& .MuiSlider-rail":{bgcolor:"rgba(124, 179, 66, 0.3)"}}})]})]}),e.jsxs(h,{direction:"row",justifyContent:"space-between",alignItems:"center",mt:2,children:[e.jsx(o,{variant:"caption",sx:{color:"#e0e0e0",fontSize:"0.8rem"},children:W?"Loading strains...":e.jsxs(e.Fragment,{children:["Showing ",g.length," of ",f.length," strains",f.length<m.length&&` (filtered from ${m.length} total)`,!$e&&" - Loading all strains..."]})}),Ve&&e.jsx(y,{size:"small",variant:"text",onClick:()=>{ee(!1),P()},sx:{color:"#7cb342"},children:"Show all strains"}),b.length>0&&e.jsx(ds,{title:"View favorites",children:e.jsx(z,{size:"small",icon:e.jsx(Ie,{sx:{fontSize:16}}),label:`${b.length}`,onClick:()=>{if(b.length===0){C({open:!0,message:"No favorites yet. Tap the heart on any strain to save it.",severity:"warning"});return}V(""),oe("all");const s=m.filter(r=>b.includes(r.slug));F(s),_(s.slice(0,D)),B(!1),ee(!0),C({open:!0,message:"Showing favorites only",severity:"info"})},sx:{bgcolor:"rgba(255, 64, 129, 0.2)",color:"#ff4081",cursor:"pointer",fontSize:"0.75rem",height:24,"&:hover":{bgcolor:"rgba(255, 64, 129, 0.3)"}}})})]})]}),!W&&b.length===0&&e.jsx(c,{sx:{mb:3},children:e.jsx(ws,{title:"No favorites yet",description:"Tap the heart icon on any strain to pin it here for quick access.",icon:e.jsx(ke,{sx:{fontSize:48,color:"#ff4081"}})})}),W?e.jsx(c,{sx:{display:"flex",justifyContent:"center",py:8},children:e.jsx(ze,{sx:{color:"#7cb342"}})}):e.jsxs(e.Fragment,{children:[e.jsx(h,{spacing:1,children:Ke.map(s=>{const r=s.type==="indica"?100:s.type==="sativa"?0:50,i=100-r,t=s.type==="indica"?"#7b1fa2":s.type==="sativa"?"#f57c00":"#00897b",n=f.findIndex(l=>l.slug===s.slug)+1;return e.jsxs(v,{onClick:()=>Xe(s),sx:{p:1.5,cursor:"pointer",background:"rgba(255,255,255,0.1)",backdropFilter:"blur(20px)",border:`2px solid ${t}40`,borderRadius:2,transition:"all 0.2s ease","&:hover":{transform:"translateX(4px)",border:`2px solid ${t}`,boxShadow:`0 4px 16px ${t}40`}},children:[e.jsx(c,{sx:{width:"100%",aspectRatio:"16/9",overflow:"hidden",borderRadius:1,mb:1,bgcolor:"transparent",display:"flex",alignItems:"center",justifyContent:"center",minHeight:120,position:"relative"},children:e.jsx(ks,{strain:s})}),e.jsxs(h,{direction:"row",alignItems:"center",spacing:1,children:[e.jsxs(o,{variant:"caption",sx:{color:"#7cb342",fontWeight:700,fontSize:"0.7rem",minWidth:32,textAlign:"right",opacity:.7},children:["#",n]}),e.jsx(H,{size:"small",onClick:l=>{l.stopPropagation(),rs(s.slug)},sx:{color:b.includes(s.slug)?"#ff4081":"#666",padding:"2px","&:hover":{color:"#ff4081",transform:"scale(1.2)"}},children:b.includes(s.slug)?e.jsx(Ie,{sx:{fontSize:18}}):e.jsx(ke,{sx:{fontSize:18}})}),e.jsx(o,{variant:"body1",sx:{color:"#fff",fontWeight:700,flex:1,fontSize:"0.85rem",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:s.name}),e.jsxs(h,{direction:"row",alignItems:"center",spacing:.3,sx:{minWidth:55,flexShrink:0},children:[e.jsxs(o,{variant:"caption",sx:{color:"#7b1fa2",fontWeight:600,fontSize:"0.65rem"},children:["I",r]}),e.jsx(o,{variant:"caption",sx:{color:"#666",fontSize:"0.65rem"},children:"|"}),e.jsxs(o,{variant:"caption",sx:{color:"#f57c00",fontWeight:600,fontSize:"0.65rem"},children:["S",i]})]}),s.thc&&e.jsx(z,{label:`${s.thc}%`,size:"small",sx:{bgcolor:"#7cb342",color:"#fff",fontWeight:700,fontSize:"0.65rem",height:20,minWidth:40,flexShrink:0,"& .MuiChip-label":{px:.5}}}),e.jsx(z,{label:s.type||"Unk",size:"small",sx:{bgcolor:t,color:"#fff",fontWeight:700,fontSize:"0.65rem",height:20,minWidth:45,flexShrink:0,textTransform:"capitalize","& .MuiChip-label":{px:.5}}})]})]},s.slug)})}),Array.isArray(g)&&g.length>re&&e.jsx(c,{sx:{textAlign:"center",padding:"16px 0"},children:e.jsx(y,{type:"button",onClick:()=>xe(s=>s+300),variant:"contained",sx:{padding:"10px 18px",borderRadius:999,fontWeight:600,fontSize:14,bgcolor:"#7cb342","&:hover":{bgcolor:"#689f38"}},children:"Load 300 more strains"})}),e.jsxs(c,{ref:fe,sx:{py:4,display:"flex",flexDirection:"column",alignItems:"center",gap:2},children:[$&&g.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ze,{size:30,sx:{color:"#7cb342"}}),e.jsx(o,{variant:"body2",sx:{color:"#7cb342",fontWeight:600},children:"Loading more strains..."})]}),!$&&g.length>0&&g.length===f.length&&e.jsxs(h,{direction:"row",alignItems:"center",spacing:1,children:[e.jsxs(o,{variant:"body2",sx:{color:"#e0e0e0"},children:["All ",f.length," strains displayed!"]}),e.jsx(c,{component:"img",src:"/hero.png?v=13",alt:"",sx:{width:16,height:16,borderRadius:"50%",filter:"drop-shadow(0 0 4px rgba(124, 179, 66, 0.6))"}})]})]})]}),e.jsxs(hs,{open:De,onClose:()=>T(!1),maxWidth:"md",fullWidth:!0,fullScreen:!0,slotProps:{paper:{sx:{background:"linear-gradient(135deg, rgba(30, 30, 30, 0.98) 0%, rgba(20, 20, 20, 0.98) 100%)",backdropFilter:"blur(20px)",border:"2px solid rgba(124, 179, 66, 0.3)",borderRadius:{xs:0,sm:4},m:0,maxHeight:"100vh"}}},children:[e.jsx(xs,{sx:{color:"#fff",fontWeight:700,borderBottom:"1px solid rgba(124, 179, 66, 0.3)",pt:"calc(env(safe-area-inset-top) + 16px)"},children:e.jsxs(h,{direction:"row",justifyContent:"space-between",alignItems:"center",spacing:2,children:[e.jsxs(c,{sx:{flex:1},children:[e.jsx(o,{variant:"h5",sx:{fontWeight:700,fontSize:{xs:"1.25rem",sm:"1.5rem"}},children:d?.name}),e.jsx(z,{label:d?.type||"Unknown",size:"small",sx:{bgcolor:ss(d?.type),color:"#fff",fontWeight:600,mt:1}})]}),e.jsxs(h,{direction:"row",spacing:1,alignItems:"center",children:[e.jsx(y,{size:"small",variant:"contained",startIcon:e.jsx(fs,{}),onClick:()=>Qe(d),children:"Log experience"}),e.jsx(y,{size:"small",variant:"outlined",startIcon:e.jsx(gs,{}),onClick:()=>{T(!1),window.dispatchEvent(new CustomEvent("nav:set-view",{detail:"grow-coach"}))},sx:{color:"#fff",borderColor:"rgba(255,255,255,0.3)"},children:"Grow log"}),e.jsx(H,{onClick:()=>T(!1),sx:{color:"#fff"},children:e.jsx(ve,{})})]})]})}),e.jsxs(us,{sx:{pt:2},children:[e.jsxs(ps,{value:ae,onChange:(s,r)=>ne(r),sx:{borderBottom:"1px solid rgba(124, 179, 66, 0.3)",mb:3},children:[e.jsx(U,{label:"Overview",sx:{color:"#fff","&.Mui-selected":{color:"#7cb342"}}}),e.jsx(U,{label:`Seed Vendors (${J.length})`,sx:{color:"#fff","&.Mui-selected":{color:"#7cb342"}}}),e.jsx(U,{label:`Dispensaries (${q.length})`,sx:{color:"#fff","&.Mui-selected":{color:"#7cb342"}}}),e.jsx(U,{label:`Reviews (${Q.length})`,sx:{color:"#fff","&.Mui-selected":{color:"#7cb342"}}})]}),ts()]})]}),e.jsx(bs,{open:O.open,autoHideDuration:3e3,onClose:()=>C({...O,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:e.jsx(Ae,{onClose:()=>C({...O,open:!1}),severity:O.severity,sx:{width:"100%"},children:O.message})}),e.jsx(ys,{open:Je,defaults:qe,onClose:()=>se(!1),onSaved:()=>{se(!1),C({open:!0,message:"Journal entry saved.",severity:"success"})}})]})})]})}export{Os as default};
