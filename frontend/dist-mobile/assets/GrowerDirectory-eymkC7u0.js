import{r as n,j as r,C as G,S as a,i as p,B as l,T as i,f as j,h as u,a0 as b,M as z,H as c,aj as B,ax as E}from"./react-vendor-CxfKVgr3.js";import{a as _}from"./App-JmJcCWdD.js";import R from"./GrowerRegistration-CDt-qoyN.js";import"./vendor-DCH4KwNm.js";function T({onBack:w}){const[x,g]=n.useState([]),[v,A]=n.useState(!0),[C,h]=n.useState(!1);n.useEffect(()=>{(async()=>{try{const e=await fetch(`${_}/api/growers`);if(e.ok){const s=await e.json(),t=Array.isArray(s)?s:Array.isArray(s.growers)?s.growers:[];g(t)}}finally{A(!1)}})()},[]);const S=n.useMemo(()=>e=>Array.isArray(e)?e.filter(Boolean):[],[]),k=e=>{const s=e.display_name||e.grower_farm_name||"Grower",t=e.display_name&&e.grower_farm_name&&e.grower_farm_name!==e.display_name?e.grower_farm_name:null,m=S(e.profile_tags),d=e.role==="admin"?"Admin":e.role==="moderator"?"Moderator":e.role==="grower"?"Grower":null;return r.jsx(b,{item:!0,xs:12,sm:6,md:4,children:r.jsx(j,{sx:{height:"100%",background:"rgba(255,255,255,0.10)",backdropFilter:"blur(12px)",border:"2px solid black",boxShadow:"none"},children:r.jsx(u,{children:r.jsxs(a,{spacing:2,children:[r.jsxs(a,{direction:"row",spacing:2,alignItems:"center",children:[r.jsx(z,{sx:{bgcolor:"primary.main",width:56,height:56},children:s.substring(0,2).toUpperCase()}),r.jsxs(l,{sx:{flex:1},children:[r.jsx(i,{variant:"h6",children:s}),t&&r.jsx(i,{variant:"body2",color:"text.secondary",children:t}),e.grower_certified&&r.jsx(c,{label:"Certified",color:"success",size:"small",sx:{mt:.5,alignSelf:"flex-start"}}),e.grower_city&&r.jsxs(a,{direction:"row",spacing:.5,alignItems:"center",children:[r.jsx(B,{fontSize:"small",color:"action"}),r.jsxs(i,{variant:"body2",color:"text.secondary",children:[e.grower_city,e.grower_state?`, ${e.grower_state}`:""]})]}),r.jsxs(a,{direction:"row",spacing:1,sx:{mt:1,flexWrap:"wrap"},children:[d&&r.jsx(c,{label:d,size:"small",color:"warning",variant:"outlined"}),m.slice(0,3).map(o=>r.jsx(c,{label:o.replace(/_/g," "),size:"small",variant:"outlined"},o))]})]})]}),Array.isArray(e.grower_specialties)&&e.grower_specialties.length>0&&r.jsxs(l,{children:[r.jsx(i,{variant:"caption",color:"text.secondary",children:"Specialties:"}),r.jsx(a,{direction:"row",spacing:.5,flexWrap:"wrap",sx:{mt:.5},children:e.grower_specialties.map((o,y)=>r.jsx(c,{label:o,size:"small",color:"success",variant:"outlined"},y))})]}),r.jsxs(i,{variant:"body2",color:"text.secondary",children:["Experience: ",e.grower_experience_years||0," years"]}),r.jsx(c,{icon:r.jsx(E,{fontSize:"small"}),label:e.grower_license_status==="licensed"?"Licensed":"Community",size:"small",sx:{alignSelf:"flex-start"}}),r.jsx(p,{variant:"outlined",size:"small",onClick:()=>h(!0),children:"Edit / View Profile"})]})})})},e.user_id||e.id)},f=(e,s)=>{if(!s||s.length===0)return null;const t=[...s].sort((m,d)=>{const o=Number(m.grower_experience_years)||0;return(Number(d.grower_experience_years)||0)-o});return r.jsxs(l,{children:[r.jsx(i,{variant:"h5",sx:{mb:2,fontWeight:700},children:e}),r.jsx(b,{container:!0,spacing:2,children:t.map(k)})]})};return C?r.jsx(R,{onBack:()=>{h(!1),(async()=>{try{const e=await fetch(`${_}/api/growers`);if(e.ok){const s=await e.json(),t=Array.isArray(s)?s:Array.isArray(s.growers)?s.growers:[];g(t)}}catch(e){console.error("Error refreshing growers:",e)}})()}}):r.jsxs(G,{maxWidth:"lg",sx:{pt:"calc(env(safe-area-inset-top) + 48px)",pb:4},children:[r.jsxs(a,{direction:"row",justifyContent:"space-between",alignItems:"center",sx:{mb:3},children:[w&&r.jsx(p,{onClick:w,size:"small",variant:"contained",sx:{bgcolor:"#7CB342",color:"white",textTransform:"none",fontWeight:700,borderRadius:999,"&:hover":{bgcolor:"#689f38"}},children:"â† Back to Garden"}),r.jsx(p,{variant:"contained",color:"primary",onClick:()=>h(!0),sx:{textTransform:"none",fontWeight:600},children:"Register as Grower"})]}),r.jsxs(l,{sx:{display:"flex",alignItems:"center",gap:2,mb:3},children:[r.jsx(l,{sx:{width:60,height:60,borderRadius:"50%",background:"transparent",border:"2px solid rgba(124, 179, 66, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 0 20px rgba(124, 179, 66, 0.4)",overflow:"hidden",flexShrink:0},children:r.jsx("img",{src:"/hero.png?v=13",alt:"StrainSpotter",style:{width:"100%",height:"100%",objectFit:"cover"}})}),r.jsx(i,{variant:"h4",sx:{fontWeight:700},children:"Grower Directory"})]}),v?r.jsx(i,{children:"Loading..."}):x.length===0?r.jsx(j,{children:r.jsx(u,{sx:{textAlign:"center",py:5},children:r.jsx(i,{variant:"body1",color:"text.secondary",children:"No growers yet. Be the first to register!"})})}):r.jsxs(a,{spacing:4,children:[f("Certified Growers",x.filter(e=>e.grower_certified)),f("Community Growers",x.filter(e=>!e.grower_certified))]})]})}export{T as default};
