import{j as r,B as a,T as n,f as z,h as M,H as D}from"./react-vendor-CxfKVgr3.js";import{c as K}from"./App-JmJcCWdD.js";import{u as G}from"./useStrainImage-pCt_md2M.js";const $=["set the","set the experience","set the vape","set the full spectrum","full spectrum vape cartridge","full spectrum cartridge","full spectrum totals","total cannabinoids","activation time","activation approx","activation approx.","for use by","not approved","keep out of reach","testing lab","lab:","coa","batch","date made","test date","exp. date","suite","tel","ocked the rich te","rm. our full-spectrum","rm. our full-spectre","r full spectrum prode"];function ar(i){if(!i)return null;let s=String(i).trim().replace(/\s+/g," ");if(s.length<3)return null;const e=s.toLowerCase();return $.some(x=>e.includes(x))?null:s}function H(i){if(!i)return null;const s=i.result||i||{},e=s.ai_summary||i.ai_summary||s.aiSummary||i.aiSummary||{},x=s.packaging_insights||i.packaging_insights||s.packagingInsights||i.packagingInsights||{},d=s.label_insights||i.label_insights||s.labelInsights||i.labelInsights||{},c=s.visualMatches?.[0]||i.result?.visualMatches?.[0]||null,h=i.canonicalStrain||s.canonicalStrain||s.canonical_strain||i.canonical_strain||null,o=s.seedBank||s.seed_bank||null,t=s.growProfile||s.grow_profile||null,u=s.plant_health||s.plantHealth||null,m=!!x.strainName||!!d.strainName||h?.source==="packaging";let p=null;if(h&&h.name&&h.name!=="Cannabis (strain unknown)")p=h.name;else{const R=x.strainName||d.strainName||null,w=c?.name&&c.confidence>=.8?c.name:null;p=m?R:w}const y=m&&(h&&h.confidence===1||!!x.strainName||!!d.strainName),g=!m&&!p,v=x.potency||{},N=v.thc_percent??v.thc_total_percent??d.thc??null,I=v.cbd_percent??v.cbd_total_percent??d.cbd??null,P=e.intensity||null,W=Array.isArray(e.effects)?e.effects:Array.isArray(e.effectsAndUseCases)?e.effectsAndUseCases:[],_=Array.isArray(e.flavors)?e.flavors:[],T=Array.isArray(e.aromas)?e.aromas:[],C=typeof e.summary=="string"?e.summary:typeof e.userFacingSummary=="string"?e.userFacingSummary:"",k=Array.isArray(e.dispensaryNotes)?e.dispensaryNotes:typeof e.dispensaryNotes=="string"&&e.dispensaryNotes.trim()?[e.dispensaryNotes.trim()]:typeof e.dispensary_notes=="string"&&e.dispensary_notes.trim()?[e.dispensary_notes.trim()]:Array.isArray(e.dispensary_notes)?e.dispensary_notes:[],f=Array.isArray(e.growerNotes)?e.growerNotes:typeof e.growerNotes=="string"&&e.growerNotes.trim()?[e.growerNotes.trim()]:typeof e.grower_notes=="string"&&e.grower_notes.trim()?[e.grower_notes.trim()]:Array.isArray(e.grower_notes)?e.grower_notes:[],j=Array.isArray(e.warnings)?e.warnings:Array.isArray(e.risksAndWarnings)?e.risksAndWarnings:[];let b=[],S=[];const A=c?.confidence||i.match_confidence||0;m?(b=W||[],S=_||[]):A>=.8?(b=W||[],S=_||[]):(b=[],S=[]);let B=p||"Cannabis (strain unknown)";m&&h&&h.confidence===1&&h.name&&(B=h.name);const U=s.strainHeroImageUrl||h?.heroImageUrl||h?.image_url||null,E=i.image_url||null,l=U||E||null;return{strainName:B,canonicalStrain:h,seedBank:o,growProfile:t,plantHealth:u,isPackagedProduct:m,isPackagedKnown:y,isBudUnknown:g,matchConfidence:h?.confidence??A,thc:N,cbd:I,effectsTags:Array.isArray(b)?b:[],flavorTags:Array.isArray(S)?S:[],intensity:P,dispensaryNotes:Array.isArray(k)?k:[],growerNotes:Array.isArray(f)?f:[],warnings:Array.isArray(j)?j:[],summary:C||null,aromaTags:Array.isArray(T)?T:[],heroImageUrl:l,scanImageUrl:E,aiIntensity:P,aiSummaryText:C,aiDispensaryNotes:Array.isArray(k)?k:[],aiGrowerNotes:Array.isArray(f)?f:[],aiWarnings:Array.isArray(j)?j:[],packaging_insights:x,label_insights:d,ai_summary:e,result:i.result||s}}function er(i){if(!i)return null;const s=i.result||i||{},e=H(i);if(!e)return null;let x=[];if(s.visualMatches){const y=s.visualMatches.match,g=Array.isArray(s.visualMatches.candidates)?s.visualMatches.candidates:[];y?x=[y,...g]:g.length>0&&(x=g)}let d=[];Array.isArray(s.matches)?d=s.matches:s.match&&(d=[s.match]);const c=x.length>0?x:d,h=y=>{const g=y.strain||y,v=y.confidence??y.score??y.probability??0,N=g.strain_slug||g.slug||g.id||null;return{id:N||g.name||"unknown",slug:N,name:g.name||"Unknown strain",type:g.type||g.category||"Hybrid",description:g.description||g.summary||"",confidence:v,dbMeta:g}},[o,...t]=c.length>0?c:[null],u=s.labelInsights||s.visualMatches?.labelInsights||e.label_insights||null;u&&!u.rawText&&(u.rawText=s.rawText||s.detectedText||"");const m=s.matched_strain_slug||i?.matched_strain_slug||o?.strain?.strain_slug||o?.strain?.slug||o?.strain_slug||o?.slug||e.matched_strain_slug||null,p=s.packagingInsights||e.packaging_insights||null;return{topMatch:o?h(o):null,otherMatches:t.map(h),matches:c.map(h),matched_strain_slug:m,labelInsights:u,aiSummary:u?.aiSummary||e.ai_summary||null,isPackagedProduct:e.isPackagedProduct||!1,packagingInsights:p,visionRaw:s.vision_raw||null,strainName:e.strainName,strainSource:e.strainSource,effectsTags:e.effectsTags,flavorTags:e.flavorTags,matchConfidence:e.matchConfidence}}function sr({isPackagedProduct:i,category:s,productType:e}){if(i){const x=(s||"").toLowerCase(),d=(e||"").toLowerCase();return x==="vape"||d.includes("vape")||d.includes("cartridge")?"Vape cartridge":x==="concentrate"||d.includes("concentrate")||d.includes("sauce")||d.includes("rosin")||d.includes("wax")||d.includes("shatter")?"Concentrate":d.includes("pre-roll")||d.includes("preroll")?"Pre-roll":x==="edible"||d.includes("edible")?"Edible":x==="flower"||d.includes("flower")?"Flower":"Packaged product"}return s==="flower"?"Flower strain":"Plant"}function V({intensity:i,effects:s,flavors:e,dispensaryNotes:x,growerNotes:d,warnings:c,summary:h}){return!i&&(!s||s.length===0)&&(!e||e.length===0)&&(!x||x.length===0)&&(!d||d.length===0)&&(!c||c.length===0)&&!h?null:r.jsxs(a,{sx:{mt:3,p:3,borderRadius:2,background:"rgba(0, 0, 0, 0.35)",backdropFilter:"blur(12px)",border:"1px solid rgba(124, 179, 66, 0.2)"},children:[r.jsx(n,{variant:"overline",sx:{color:"rgba(200, 230, 201, 0.7)",textTransform:"uppercase",letterSpacing:1,fontSize:"0.75rem",fontWeight:600},children:"AI STRAIN DETAILS"}),i!=null&&r.jsxs(a,{sx:{mt:1},children:[r.jsxs(n,{variant:"caption",sx:{color:"rgba(200, 230, 201, 0.7)",display:"block",mb:.5},children:["Intensity",typeof i=="string"&&`: ${i}`]}),(()=>{let o=0;if(typeof i=="number")o=i;else if(typeof i=="string"){const t=i.toUpperCase();t==="HIGH"?o=.9:t==="MEDIUM"?o=.6:t==="LOW"&&(o=.3)}return r.jsx(a,{sx:{mt:.5,display:"flex",gap:.5},children:Array.from({length:5}).map((t,u)=>{const m=o>=(u+1)/5;return r.jsx(a,{sx:{width:10,height:10,borderRadius:"50%",opacity:m?1:.3,backgroundColor:"#9AE66E"}},u)})})})()]}),s&&s.length>0&&r.jsxs(a,{sx:{mt:2},children:[r.jsx(n,{variant:"caption",sx:{color:"rgba(200, 230, 201, 0.7)",display:"block",mb:.5},children:"Likely effects"}),r.jsx(a,{sx:{mt:.5,display:"flex",flexWrap:"wrap",gap:.5},children:Array.isArray(s)&&s.map((o,t)=>r.jsx(D,{size:"small",label:typeof o=="string"?o:o.name||String(o),sx:{bgcolor:"rgba(178, 255, 89, 0.08)",border:"1px solid rgba(200, 255, 140, 0.85)",color:"#e8ffca",fontSize:"0.75rem"}},t))})]}),e&&e.length>0&&r.jsxs(a,{sx:{mt:2},children:[r.jsx(n,{variant:"caption",sx:{color:"rgba(200, 230, 201, 0.7)",display:"block",mb:.5},children:"Aroma & flavor"}),r.jsx(a,{sx:{mt:.5,display:"flex",flexWrap:"wrap",gap:.5},children:Array.isArray(e)&&e.map((o,t)=>r.jsx(D,{size:"small",label:typeof o=="string"?o:o.name||String(o),sx:{bgcolor:"rgba(255, 248, 225, 0.06)",border:"1px solid rgba(255, 236, 179, 0.7)",color:"#fff8e1",fontSize:"0.75rem"}},t))})]}),h&&r.jsxs(a,{sx:{mt:2},children:[r.jsx(n,{variant:"caption",sx:{color:"rgba(200, 230, 201, 0.7)",display:"block",mb:.5},children:"Overview"}),r.jsx(n,{variant:"body2",sx:{color:"rgba(224, 242, 241, 0.85)",lineHeight:1.6,mt:.5},children:h})]}),x&&x.length>0&&r.jsxs(a,{sx:{mt:2},children:[r.jsx(n,{variant:"caption",sx:{color:"rgba(200, 230, 201, 0.7)",display:"block",mb:.5},children:"For dispensaries"}),r.jsx(a,{component:"ul",sx:{marginTop:.5,paddingLeft:2.25,marginBottom:0},children:Array.isArray(x)&&x.map((o,t)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(224, 242, 241, 0.85)"},children:o})},t))})]}),d&&d.length>0&&r.jsxs(a,{sx:{mt:2},children:[r.jsx(n,{variant:"caption",sx:{color:"rgba(200, 230, 201, 0.7)",display:"block",mb:.5},children:"For growers"}),r.jsx(a,{component:"ul",sx:{marginTop:.5,paddingLeft:2.25,marginBottom:0},children:Array.isArray(d)&&d.map((o,t)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(224, 242, 241, 0.85)"},children:o})},t))})]}),c&&c.length>0&&r.jsxs(a,{sx:{mt:2},children:[r.jsx(n,{variant:"caption",sx:{color:"rgba(200, 230, 201, 0.7)",display:"block",mb:.5},children:"Warnings"}),r.jsx(a,{component:"ul",sx:{marginTop:.5,paddingLeft:2.25,marginBottom:0},children:Array.isArray(c)&&c.map((o,t)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(255, 152, 152, 0.9)"},children:o})},t))})]})]})}function Y({strainName:i,thc:s,cbd:e,summary:x,effects:d,flavors:c,intensity:h,dispensaryNotes:o,growerNotes:t,warnings:u,result:m,scan:p,proRole:y,proEnabled:g,growProfile:v,canonicalStrain:N,heroImageUrl:I,plantHealth:P,packagingInsights:W,labelInsights:_,displayBreeder:T,displayType:C,aiSummary:k}){const f=W||m?.packaging_insights||p?.packaging_insights||p?.result?.packaging_insights||null,j=_||m?.label_insights||p?.label_insights||p?.result?.label_insights||null,b=P||m?.plant_health||p?.plant_health||p?.result?.plant_health||null,S=v||m?.grow_profile||p?.grow_profile||p?.result?.grow_profile||null,A=k||m?.ai_summary||m?.aiSummary||p?.ai_summary||p?.aiSummary||p?.result?.ai_summary||p?.result?.aiSummary||null,B=f?.lineage||j?.lineage||null,U=f?.basic||{},E=f?.package_details||{},l=U.brand_name||E.brand||j?.brandName||null,R=s!=null||e!=null;return r.jsxs(r.Fragment,{children:[I&&r.jsx(a,{sx:{mb:2,borderRadius:2,overflow:"hidden",border:"1px solid",borderColor:"rgba(124, 179, 66, 0.3)"},children:r.jsx(a,{component:"img",src:I,alt:i||"Strain photo",sx:{width:"100%",height:220,objectFit:"cover",display:"block"},onError:w=>{w.currentTarget.style.display="none"}})}),r.jsx(z,{variant:"outlined",sx:{mb:2,borderColor:"rgba(165, 214, 167, 0.35)",background:"#0a0f0a"},children:r.jsx(M,{children:r.jsxs(a,{sx:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1},children:[r.jsxs(a,{sx:{flex:1},children:[r.jsxs(a,{sx:{display:"flex",alignItems:"center",gap:1,mb:.5},children:[r.jsx(n,{variant:"overline",sx:{color:"rgba(200, 230, 201, 0.7)",letterSpacing:1},children:"Label-based match"}),g&&y&&r.jsx(D,{label:y==="dispensary"?"Dispensary":"Grower",size:"small",sx:{height:"20px",fontSize:"0.65rem",bgcolor:"rgba(124, 179, 66, 0.2)",color:"#9AE66E",border:"1px solid rgba(124, 179, 66, 0.4)"}})]}),r.jsx(n,{variant:"h6",sx:{fontWeight:700,color:"#E8F5E9",mb:.5},children:i}),(T||C)&&r.jsxs(a,{sx:{mb:.5},children:[T&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",fontSize:"0.875rem",mb:.25},children:[r.jsx("strong",{children:"Breeder:"})," ",T]}),C&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.75)",fontSize:"0.875rem",mb:.25},children:[r.jsx("strong",{children:"Type:"})," ",C]})]}),B&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.75)",fontSize:"0.875rem",mb:.5},children:["Lineage: ",B]}),l&&r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:1},children:l})]}),R&&r.jsxs(a,{sx:{ml:2,textAlign:"right"},children:[s!=null&&r.jsx(D,{label:`THC ${s}%`,size:"small",sx:{bgcolor:"rgba(255, 204, 128, 0.15)",color:"#FFCC80",border:"1px solid rgba(255, 204, 128, 0.3)",mb:.5,display:"block"}}),e!=null&&r.jsx(D,{label:`CBD ${e}%`,size:"small",sx:{bgcolor:"rgba(179, 229, 252, 0.15)",color:"#B3E5FC",border:"1px solid rgba(179, 229, 252, 0.3)"}})]})]})})}),f&&r.jsxs(a,{sx:{mt:3,p:3,borderRadius:2,background:"rgba(0, 0, 0, 0.35)",backdropFilter:"blur(12px)",border:"1px solid rgba(124, 179, 66, 0.2)",mb:2},children:[r.jsx(n,{variant:"h6",sx:{color:"rgba(200, 230, 201, 0.9)",fontWeight:600,fontSize:"1rem",mb:1},children:"Packaging summary"}),f.overallConfidence!=null&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:["Match confidence: ",((f.overallConfidence||0)*100).toFixed(0),"%"]}),f.thc!=null&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5,mt:.5},children:[r.jsx("strong",{children:"Label THC:"})," ",f.thc,"%"]}),f.cbd!=null&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5,mt:.5},children:[r.jsx("strong",{children:"Label CBD:"})," ",f.cbd,"%"]})]}),j&&(j.batchNumber||j.packagedDate||j.testingLab)&&r.jsxs(a,{sx:{mt:2,p:3,borderRadius:2,background:"rgba(0, 0, 0, 0.35)",backdropFilter:"blur(12px)",border:"1px solid rgba(124, 179, 66, 0.2)",mb:2},children:[r.jsx(n,{variant:"overline",sx:{color:"rgba(200, 230, 201, 0.7)",textTransform:"uppercase",letterSpacing:1,fontSize:"0.75rem",fontWeight:600,display:"block",mb:2},children:"Additional Details"}),j?.batchNumber&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:[r.jsx("strong",{children:"Batch:"})," ",j.batchNumber]}),j?.packagedDate&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:[r.jsx("strong",{children:"Packaged:"})," ",j.packagedDate]}),j?.testingLab&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:[r.jsx("strong",{children:"Testing Lab:"})," ",j.testingLab]})]}),(b||S)&&r.jsxs(a,{sx:{mt:3,p:3,borderRadius:2,background:"rgba(0, 0, 0, 0.35)",backdropFilter:"blur(12px)",border:"1px solid rgba(124, 179, 66, 0.2)"},children:[r.jsx(n,{variant:"overline",sx:{color:"rgba(200, 230, 201, 0.7)",textTransform:"uppercase",letterSpacing:1,fontSize:"0.75rem",fontWeight:600,display:"block",mb:2},children:"Plant Health & Diagnostics"}),b?.overall_health&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:[r.jsx("strong",{children:"Overall Health:"})," ",b.overall_health]}),b?.issues&&Array.isArray(b.issues)&&b.issues.length>0&&r.jsxs(a,{sx:{mt:1},children:[r.jsx(n,{variant:"body2",sx:{color:"rgba(255, 152, 152, 0.9)",mb:.5,fontWeight:600},children:"Issues Detected:"}),r.jsx(a,{component:"ul",sx:{marginTop:.5,paddingLeft:2.25,marginBottom:0},children:b.issues.map((w,F)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(255, 152, 152, 0.9)"},children:w})},F))})]}),b?.recommendations&&Array.isArray(b.recommendations)&&b.recommendations.length>0&&r.jsxs(a,{sx:{mt:2},children:[r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5,fontWeight:600},children:"Recommendations:"}),r.jsx(a,{component:"ul",sx:{marginTop:.5,paddingLeft:2.25,marginBottom:0},children:b.recommendations.map((w,F)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)"},children:w})},F))})]})]}),A&&(d.length>0||c.length>0)&&r.jsxs(a,{sx:{mt:3,p:3,borderRadius:2,background:"rgba(0, 0, 0, 0.35)",backdropFilter:"blur(12px)",border:"1px solid rgba(124, 179, 66, 0.2)",mb:2},children:[r.jsx(n,{variant:"h6",sx:{color:"rgba(200, 230, 201, 0.9)",fontWeight:600,fontSize:"1rem",mb:1},children:"Effects & flavors"}),d.length>0&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5,mt:.5},children:[r.jsx("strong",{children:"Effects:"})," ",d.join(", ")]}),c.length>0&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5,mt:.5},children:[r.jsx("strong",{children:"Flavors:"})," ",c.join(", ")]})]}),A&&(o.length>0||t.length>0)&&r.jsxs(a,{sx:{mt:2,p:3,borderRadius:2,background:"rgba(0, 0, 0, 0.35)",backdropFilter:"blur(12px)",border:"1px solid rgba(124, 179, 66, 0.2)",mb:2},children:[r.jsx(n,{variant:"h6",sx:{color:"rgba(200, 230, 201, 0.9)",fontWeight:600,fontSize:"1rem",mb:1},children:"Notes"}),o.length>0&&r.jsxs(a,{sx:{mb:2},children:[r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5,fontWeight:600},children:r.jsx("strong",{children:"Dispensary:"})}),r.jsx(a,{component:"ul",sx:{paddingLeft:2.25,margin:"4px 0",mt:.5},children:o.map((w,F)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)"},children:w})},F))})]}),t.length>0&&r.jsxs(a,{children:[r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5,fontWeight:600},children:r.jsx("strong",{children:"Grower:"})}),r.jsx(a,{component:"ul",sx:{paddingLeft:2.25,margin:"4px 0",mt:.5},children:t.map((w,F)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)"},children:w})},F))})]})]}),A&&(A.thc!=null||A.cbd!=null||u.length>0)&&r.jsxs(a,{sx:{mt:2,p:3,borderRadius:2,background:"rgba(0, 0, 0, 0.35)",backdropFilter:"blur(12px)",border:"1px solid rgba(124, 179, 66, 0.2)",mb:2},children:[r.jsx(n,{variant:"h6",sx:{color:"rgba(200, 230, 201, 0.9)",fontWeight:600,fontSize:"1rem",mb:1},children:"Potency & Warnings"}),(A.thc!=null||A.cbd!=null)&&r.jsxs(a,{sx:{mb:2},children:[A.thc!=null&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:[r.jsx("strong",{children:"Estimated THC:"})," ",A.thc,"%"]}),A.cbd!=null&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:[r.jsx("strong",{children:"Estimated CBD:"})," ",A.cbd,"%"]})]}),u.length>0&&r.jsxs(a,{children:[r.jsx(n,{variant:"body2",sx:{color:"rgba(255, 152, 152, 0.9)",mb:.5,fontWeight:600},children:"Warnings:"}),r.jsx(a,{component:"ul",sx:{marginTop:.5,paddingLeft:2.25,marginBottom:0},children:u.map((w,F)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(255, 152, 152, 0.9)"},children:w})},F))})]})]})]})}function O({isPackagedProduct:i,isPackagedKnown:s,isBudUnknown:e,summary:x,effects:d,flavors:c,intensity:h,dispensaryNotes:o,growerNotes:t,warnings:u,canonicalStrain:m,result:p,scan:y,plantHealth:g,growProfile:v,displayName:N,hasStrainName:I,isLikelyPlantOnly:P,aiSummary:W}){if(i&&(s||m&&m.confidence===1))return null;const _=W||p?.ai_summary||p?.aiSummary||y?.ai_summary||y?.aiSummary||y?.result?.ai_summary||y?.result?.aiSummary||null,C=!i&&(g||v);let k="Cannabis (strain unknown)",f="STRAIN UNKNOWN • 0%",j="";return i&&!s?(k="Packaged product (strain unknown)",f="STRAIN UNKNOWN • 0%",j="This looks like a packaged product, but the strain name was not clearly detected from the label. THC, CBD, and other label details may still be available below."):C?(k=N||"Unknown strain (plant detected)",f="STRAIN UNKNOWN • PLANT DETECTED",j="We detected a cannabis plant in your photo, but couldn't identify the specific strain. Plant health diagnostics and grow information are available below."):!i&&e?(k="Cannabis (strain unknown)",f="STRAIN UNKNOWN • 0%",j="For live plants and buds, this is an estimated strain based on visual and label signals. Results may vary by grower and phenotype."):(f="STRAIN UNKNOWN • 0%",j="Strain information is not available for this scan. Other label or AI details may still be shown below."),r.jsxs(r.Fragment,{children:[r.jsx(z,{variant:"outlined",sx:{mb:2,borderColor:"rgba(165, 214, 167, 0.35)",background:"#0a0f0a"},children:r.jsxs(M,{children:[r.jsx(n,{variant:"overline",sx:{color:"rgba(200, 230, 201, 0.7)",letterSpacing:1,display:"block",mb:.5},children:f}),r.jsx(n,{variant:"h6",sx:{fontWeight:700,color:"#E8F5E9",mb:.5},children:k}),r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)"},children:j})]})}),P&&r.jsx(a,{sx:{mb:2,p:2,borderRadius:2,background:"rgba(124, 179, 66, 0.15)",border:"1px solid rgba(124, 179, 66, 0.3)"},children:r.jsx(n,{variant:"body2",sx:{margin:0,fontSize:"0.8125rem",color:"rgba(200, 230, 201, 0.8)",lineHeight:1.5},children:"This looks like a plant photo. We couldn't confidently match a strain, but we analyzed the plant for health and grow signals below."})}),(g||v)&&r.jsxs(a,{sx:{mt:3,p:3,borderRadius:2,background:"rgba(0, 0, 0, 0.35)",backdropFilter:"blur(12px)",border:"1px solid rgba(124, 179, 66, 0.2)"},children:[r.jsx(n,{variant:"overline",sx:{color:"rgba(200, 230, 201, 0.7)",textTransform:"uppercase",letterSpacing:1,fontSize:"0.75rem",fontWeight:600,display:"block",mb:2},children:"Plant Health & Diagnostics"}),g?.overall_health&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:[r.jsx("strong",{children:"Overall Health:"})," ",g.overall_health]}),g?.issues&&Array.isArray(g.issues)&&g.issues.length>0&&r.jsxs(a,{sx:{mt:1},children:[r.jsx(n,{variant:"body2",sx:{color:"rgba(255, 152, 152, 0.9)",mb:.5,fontWeight:600},children:"Issues Detected:"}),r.jsx(a,{component:"ul",sx:{marginTop:.5,paddingLeft:2.25,marginBottom:0},children:g.issues.map((b,S)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(255, 152, 152, 0.9)"},children:b})},S))})]}),g?.recommendations&&Array.isArray(g.recommendations)&&g.recommendations.length>0&&r.jsxs(a,{sx:{mt:2},children:[r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5,fontWeight:600},children:"Recommendations:"}),r.jsx(a,{component:"ul",sx:{marginTop:.5,paddingLeft:2.25,marginBottom:0},children:g.recommendations.map((b,S)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)"},children:b})},S))})]})]}),v&&r.jsxs(a,{sx:{mt:3,p:3,borderRadius:2,background:"rgba(0, 0, 0, 0.35)",backdropFilter:"blur(12px)",border:"1px solid rgba(124, 179, 66, 0.2)"},children:[r.jsx(n,{variant:"overline",sx:{color:"rgba(200, 230, 201, 0.7)",textTransform:"uppercase",letterSpacing:1,fontSize:"0.75rem",fontWeight:600,display:"block",mb:2},children:"Grow Profile"}),v.vigor&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:[r.jsx("strong",{children:"Vigor:"})," ",v.vigor]}),v.harvestWeeks&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:[r.jsx("strong",{children:"Harvest:"})," ~",v.harvestWeeks," weeks"]}),v.yield&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:[r.jsx("strong",{children:"Yield:"})," ",v.yield]})]}),_&&(d.length>0||c.length>0)&&r.jsxs(a,{sx:{mt:3,p:3,borderRadius:2,background:"rgba(0, 0, 0, 0.35)",backdropFilter:"blur(12px)",border:"1px solid rgba(124, 179, 66, 0.2)",mb:2},children:[r.jsx(n,{variant:"h6",sx:{color:"rgba(200, 230, 201, 0.9)",fontWeight:600,fontSize:"1rem",mb:1},children:"Effects & flavors"}),d.length>0&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5,mt:.5},children:[r.jsx("strong",{children:"Effects:"})," ",d.join(", ")]}),c.length>0&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5,mt:.5},children:[r.jsx("strong",{children:"Flavors:"})," ",c.join(", ")]})]}),_&&(o.length>0||t.length>0)&&r.jsxs(a,{sx:{mt:2,p:3,borderRadius:2,background:"rgba(0, 0, 0, 0.35)",backdropFilter:"blur(12px)",border:"1px solid rgba(124, 179, 66, 0.2)",mb:2},children:[r.jsx(n,{variant:"h6",sx:{color:"rgba(200, 230, 201, 0.9)",fontWeight:600,fontSize:"1rem",mb:1},children:"Notes"}),o.length>0&&r.jsxs(a,{sx:{mb:2},children:[r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5,fontWeight:600},children:r.jsx("strong",{children:"Dispensary:"})}),r.jsx(a,{component:"ul",sx:{paddingLeft:2.25,margin:"4px 0",mt:.5},children:o.map((b,S)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)"},children:b})},S))})]}),t.length>0&&r.jsxs(a,{children:[r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5,fontWeight:600},children:r.jsx("strong",{children:"Grower:"})}),r.jsx(a,{component:"ul",sx:{paddingLeft:2.25,margin:"4px 0",mt:.5},children:t.map((b,S)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)"},children:b})},S))})]})]}),_&&(_.thc!=null||_.cbd!=null||u.length>0)&&r.jsxs(a,{sx:{mt:2,p:3,borderRadius:2,background:"rgba(0, 0, 0, 0.35)",backdropFilter:"blur(12px)",border:"1px solid rgba(124, 179, 66, 0.2)",mb:2},children:[r.jsx(n,{variant:"h6",sx:{color:"rgba(200, 230, 201, 0.9)",fontWeight:600,fontSize:"1rem",mb:1},children:"Potency & Warnings"}),(_.thc!=null||_.cbd!=null)&&r.jsxs(a,{sx:{mb:2},children:[_.thc!=null&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:[r.jsx("strong",{children:"Estimated THC:"})," ",_.thc,"%"]}),_.cbd!=null&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)",mb:.5},children:[r.jsx("strong",{children:"Estimated CBD:"})," ",_.cbd,"%"]})]}),u.length>0&&r.jsxs(a,{children:[r.jsx(n,{variant:"body2",sx:{color:"rgba(255, 152, 152, 0.9)",mb:.5,fontWeight:600},children:"Warnings:"}),r.jsx(a,{component:"ul",sx:{marginTop:.5,paddingLeft:2.25,marginBottom:0},children:u.map((b,S)=>r.jsx(a,{component:"li",sx:{mb:.5},children:r.jsx(n,{variant:"body2",sx:{color:"rgba(255, 152, 152, 0.9)"},children:b})},S))})]})]})]})}function q({strainName:i,matchConfidence:s,summary:e,effects:x,flavors:d,intensity:c,dispensaryNotes:h,growerNotes:o,warnings:t,result:u,scan:m,growProfile:p,canonicalStrain:y,heroImageUrl:g,plantHealth:v,packagingInsights:N,labelInsights:I,displayBreeder:P,displayType:W,aiSummary:_}){_||u?.ai_summary||u?.aiSummary||m?.ai_summary||m?.aiSummary||m?.result?.ai_summary||m?.result?.aiSummary;const T=N||u?.packaging_insights||m?.packaging_insights||m?.result?.packaging_insights||null,C=I||u?.label_insights||m?.label_insights||m?.result?.label_insights||null;v||u?.plant_health||m?.plant_health||m?.result?.plant_health;const k=T?.lineage||C?.lineage||null;return r.jsxs(r.Fragment,{children:[g&&r.jsx(a,{sx:{mb:2,borderRadius:2,overflow:"hidden",border:"1px solid",borderColor:"rgba(124, 179, 66, 0.3)"},children:r.jsx(a,{component:"img",src:g,alt:i||"Strain photo",sx:{width:"100%",height:220,objectFit:"cover",display:"block"},onError:f=>{f.currentTarget.style.display="none"}})}),r.jsx(z,{variant:"outlined",sx:{mb:2,borderColor:"rgba(165, 214, 167, 0.35)",background:"#0a0f0a"},children:r.jsxs(M,{children:[y&&y.confidence===1?r.jsx(n,{variant:"overline",sx:{color:"rgba(200, 230, 201, 0.7)",letterSpacing:1,display:"block",mb:.5},children:"Strain match"}):r.jsxs(n,{variant:"overline",sx:{color:"rgba(200, 230, 201, 0.7)",letterSpacing:1,display:"block",mb:.5},children:["Strain estimate",s!=null?` – ${Math.round(s*100)}%`:""]}),r.jsx(n,{variant:"h6",sx:{fontWeight:700,color:"#E8F5E9",mb:.5},children:i}),k&&r.jsxs(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.75)",fontSize:"0.875rem",mb:1},children:["Lineage: ",k]}),r.jsx(n,{variant:"body2",sx:{color:"rgba(200, 230, 201, 0.85)"},children:"For live plants and buds, this is an estimated strain based on visual and label signals. Results may vary by grower and phenotype."})]})}),r.jsx(V,{intensity:c,effects:x,flavors:d,dispensaryNotes:h,growerNotes:o,warnings:t,summary:e})]})}function J({result:i,scan:s,isGuest:e}){if(!s||!s.id&&!s.result)return r.jsxs(a,{sx:{p:3,textAlign:"center"},children:[r.jsx(n,{variant:"h6",color:"text.secondary",sx:{mb:2,fontWeight:600},children:"Scan ready, but details are missing"}),r.jsx(n,{variant:"body2",color:"text.secondary",sx:{mb:2,display:"block"},children:"We processed your scan, but couldn't load the full details. Try checking your scan history or scanning again."})]});const{proRole:x,proEnabled:d}=K(),c=s?.result||s||i||{},h=c.canonical_strain||c.canonicalStrain||(c.canonical_strain_name?{name:c.canonical_strain_name,source:c.canonical_strain_source||null,confidence:c.canonical_match_confidence??null}:null)||c.canonical||null,o=c.seedBank||c.seed_bank||null,t=c.ai_summary||c.aiSummary||null,u=c.packaging_insights||c.packagingInsights||null,m=c.label_insights||c.labelInsights||null,p=c.plant_health||c.plantHealth||null,y=c.grow_profile||c.growProfile||null,g=!!(h?.name||o?.name||t?.canonicalName),v=!!(p||y),N=Array.isArray(t?.effects)?t.effects:[],I=Array.isArray(t?.flavors)?t.flavors:[],P=Array.isArray(t?.dispensaryNotes)?t.dispensaryNotes:[],W=Array.isArray(t?.growerNotes)?t.growerNotes:[],_=Array.isArray(t?.warnings)?t.warnings:[],T=i||s||{},k=h?.name||o?.name||t?.canonicalName||u?.strainName||m?.strainName||(v?"Unknown strain (plant detected)":"Unknown strain"),f=o?.type||t?.type||h?.type||null,j=o?.breeder||t?.breeder||null,b=!!(g&&k&&k!=="Unknown strain"&&k!=="Unknown strain (plant detected)"),S=!!v,A=!b&&S&&!u,B=h?.name||o?.name||t?.canonicalName||null,{imageUrl:U}=G(B),E=L=>U||L||s?.image_url||null;let l=null;try{l=H(T)}catch(L){console.error("[ScanResultCard] transformScanResult error:",L)}if(!l&&S&&!b)return r.jsx(O,{isPackagedProduct:!1,isPackagedKnown:!1,isBudUnknown:!0,summary:null,effects:[],flavors:[],intensity:null,dispensaryNotes:[],growerNotes:[],warnings:[],canonicalStrain:null,result:i,scan:s,plantHealth:p,growProfile:y,displayName:k,hasStrainName:b,isLikelyPlantOnly:A,aiSummary:t});if(!l)return r.jsxs(a,{sx:{p:3,textAlign:"center"},children:[r.jsx(n,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Preparing your result…"}),r.jsx(n,{variant:"caption",color:"text.secondary",sx:{mb:2,display:"block"},children:"Your scan is processing. This may take a moment."})]});const R=l?.canonicalStrain||null,w=R&&R.confidence===1;return l?.isPackagedKnown||l?.isPackagedProduct&&w?r.jsx(Y,{strainName:k,thc:l?.thc||null,cbd:l?.cbd||null,summary:l?.summary||null,effects:l?.effectsTags||[],flavors:l?.flavorTags||[],intensity:l?.intensity||null,dispensaryNotes:l?.dispensaryNotes||[],growerNotes:l?.growerNotes||[],warnings:l?.warnings||[],result:i,scan:s,proRole:x,proEnabled:d,growProfile:y||l?.growProfile||null,canonicalStrain:R,heroImageUrl:E(l?.heroImageUrl),plantHealth:p,packagingInsights:u,labelInsights:m,displayBreeder:j,displayType:f,aiSummary:t}):(l?.isBudUnknown||l?.isPackagedProduct&&!l?.isPackagedKnown)&&!w||!b&&S&&!u?r.jsx(O,{isPackagedProduct:l?.isPackagedProduct||!1,isPackagedKnown:l?.isPackagedKnown||!1,isBudUnknown:l?.isBudUnknown||!1,summary:l?.summary||null,effects:l?.effectsTags||N||[],flavors:l?.flavorTags||I||[],intensity:l?.intensity||null,dispensaryNotes:l?.dispensaryNotes||P||[],growerNotes:l?.growerNotes||W||[],warnings:l?.warnings||_||[],canonicalStrain:R,result:i,scan:s,plantHealth:p,growProfile:y,displayName:k,hasStrainName:b,isLikelyPlantOnly:A,aiSummary:t}):l?.isPackagedProduct&&w?r.jsx(a,{sx:{p:3,textAlign:"center"},children:r.jsx(n,{variant:"body2",color:"text.secondary",children:"Processing result…"})}):r.jsx(q,{strainName:l?.strainName||k,matchConfidence:l?.matchConfidence||null,summary:l?.summary||null,effects:l?.effectsTags||N||[],flavors:l?.flavorTags||I||[],intensity:l?.intensity||null,dispensaryNotes:l?.dispensaryNotes||P||[],growerNotes:l?.growerNotes||W||[],warnings:l?.warnings||_||[],result:i,scan:s,growProfile:y||l?.growProfile||null,canonicalStrain:R,heroImageUrl:E(l?.heroImageUrl),plantHealth:p,packagingInsights:u,labelInsights:m,displayBreeder:j,displayType:f,aiSummary:t})}const ir=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));export{J as S,ir as a,ar as c,sr as g,er as n,H as t};
