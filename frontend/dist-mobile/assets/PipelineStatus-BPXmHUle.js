import{r as l,j as e,B as u,i as C,T as r,av as T,f as p,h as g,S as d,H as n,Z as D,bd as R,be as $,bf as m,bg as t,bh as A}from"./react-vendor-CxfKVgr3.js";import{a as b}from"./App-JmJcCWdD.js";import"./vendor-DCH4KwNm.js";function P({onBack:h}){const[s,f]=l.useState(null),[y,S]=l.useState([]),[v,x]=l.useState(!0),[j,w]=l.useState(null);return l.useEffect(()=>{(async()=>{try{x(!0);const[i,o]=await Promise.all([fetch(`${b}/api/pipeline/latest`).then(c=>c.json()),fetch(`${b}/api/pipeline/history`).then(c=>c.json())]);f(i),S(Array.isArray(o)?o:[o].filter(Boolean))}catch(i){console.error("[Pipeline] load error",i),w("Could not load pipeline status")}finally{x(!1)}})()},[]),e.jsxs(u,{sx:{maxWidth:1e3,mx:"auto",p:2},children:[h&&e.jsx(C,{onClick:h,size:"small",variant:"contained",sx:{bgcolor:"white",color:"black",textTransform:"none",fontWeight:700,borderRadius:999,mb:1,"&:hover":{bgcolor:"grey.100"}},children:"Home"}),e.jsx(r,{variant:"h4",sx:{fontWeight:800,mb:1},children:"Data Pipeline"}),e.jsx(r,{variant:"body1",sx:{color:"text.secondary",mb:2},children:"Schedule: Daily at 3:00 AM UTC via GitHub Actions."}),v&&e.jsx(T,{}),j&&e.jsx(r,{color:"error",sx:{mb:2},children:j}),s&&e.jsx(p,{sx:{mb:3},children:e.jsxs(g,{children:[e.jsxs(d,{direction:{xs:"column",sm:"row"},spacing:2,justifyContent:"space-between",alignItems:{xs:"flex-start",sm:"center"},children:[e.jsxs(u,{children:[e.jsx(r,{variant:"h6",sx:{fontWeight:700},children:"Latest Run"}),e.jsxs(r,{variant:"body2",sx:{color:"text.secondary"},children:["Date: ",new Date(s.date||s.when||Date.now()).toLocaleString()]})]}),e.jsxs(d,{direction:"row",spacing:1,children:[e.jsx(n,{label:`Strains (main): ${s.totals?.strainsMain??"—"}`,color:"success",variant:"outlined"}),e.jsx(n,{label:`Strains (enhanced): ${s.totals?.strainsEnhanced??"—"}`,color:"success",variant:"outlined"})]})]}),e.jsx(D,{sx:{my:2}}),e.jsx(r,{variant:"subtitle1",sx:{fontWeight:700,mb:1},children:"Import Report"}),e.jsxs(d,{direction:"row",spacing:2,flexWrap:"wrap",children:[e.jsx(n,{label:`Attributes: ${s.report?.counts?.attributes??"—"}`}),e.jsx(n,{label:`CSV Rows: ${s.report?.counts?.csvRows??"—"}`}),e.jsx(n,{label:`Matched: ${s.report?.counts?.matched??"—"}`,color:"primary"}),e.jsx(n,{label:`Unmatched: ${s.report?.counts?.unmatched??"—"}`,color:"warning"})]})]})}),e.jsx(p,{children:e.jsxs(g,{children:[e.jsx(r,{variant:"h6",sx:{fontWeight:700,mb:1},children:"Run History"}),e.jsxs(R,{size:"small",children:[e.jsx($,{children:e.jsxs(m,{children:[e.jsx(t,{children:"Date (UTC)"}),e.jsx(t,{align:"right",children:"Strains (main)"}),e.jsx(t,{align:"right",children:"Strains (enhanced)"}),e.jsx(t,{align:"right",children:"Matched"}),e.jsx(t,{align:"right",children:"Unmatched"})]})}),e.jsx(A,{children:y.map((a,i)=>e.jsxs(m,{hover:!0,children:[e.jsx(t,{children:a.date_utc||(a.date?new Date(a.date).toISOString().slice(0,10):"—")}),e.jsx(t,{align:"right",children:a.totals?.strainsMain??"—"}),e.jsx(t,{align:"right",children:a.totals?.strainsEnhanced??"—"}),e.jsx(t,{align:"right",children:a.report?.counts?.matched??"—"}),e.jsx(t,{align:"right",children:a.report?.counts?.unmatched??"—"})]},i))})]})]})})]})}export{P as default};
