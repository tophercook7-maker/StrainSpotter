import{r as n,j as e,B as a,P as V,T as t,m as ae,i as R,n as ie,S as W,aj as ye,A as Z,ak as $r,f as Ur,al as Lr,h as Br,H as xe,am as Or,I as X,an as Nr,ao as Gr,ap as Hr,aq as Yr,y as dr,C as qr,D as Ue,p as Le,ai as Be,q as Oe,ar as Jr,Z as Vr,u as Kr,as as Qr,Q as Zr,a1 as Xr,N as et,k as rt,l as je}from"./react-vendor-CxfKVgr3.js";import{a as U,c as tt,u as st,S as Ne,F as we,s as Se,E as ur}from"./App-JmJcCWdD.js";import{S as ot}from"./SeedVendorFinder-tPICLvgV.js";import{B as nt}from"./BackHeader-jnSvreF0.js";import{n as hr,c as ne,g as fr,S as xr}from"./ScanResultCard-Cv4hIP62.js";import{u as at,A as it}from"./useCanScan-Cd4tphRX.js";import{u as lt}from"./useCreditBalance-DnPtH5jr.js";function gr({onSuccess:A}){const[v,w]=n.useState(""),[_,E]=n.useState(""),[I,j]=n.useState(!1),[x,c]=n.useState(""),[D,g]=n.useState(!1),ee=async()=>{j(!0),c("");try{const l=await fetch(`${U}/api/membership/apply`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:v,full_name:_})}),$=await l.json();if(!l.ok||!$.success)throw new Error($.error||"Application failed");g(!0)}catch(l){c(l.message)}j(!1)};return e.jsx(a,{sx:{minHeight:"100vh",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"none"},children:e.jsxs(V,{sx:{p:4,borderRadius:6,minWidth:340,maxWidth:400,textAlign:"center",background:"rgba(255,255,255,0.15)",backdropFilter:"blur(20px)",border:"2px solid rgba(124, 179, 66, 0.3)"},children:[e.jsx(t,{variant:"h4",sx:{mb:2,color:"#fff",fontWeight:900},children:"Enter the Garden"}),e.jsx(t,{variant:"body1",sx:{mb:3,color:"#e0e0e0"},children:"Welcome! Please apply for membership to access the full app."}),e.jsx(ae,{label:"Full Name",value:_,onChange:l=>E(l.target.value),fullWidth:!0,sx:{mb:2}}),e.jsx(ae,{label:"Email Address",value:v,onChange:l=>w(l.target.value),fullWidth:!0,sx:{mb:2}}),x&&e.jsx(t,{color:"error",sx:{mb:2},children:x}),D?e.jsxs(e.Fragment,{children:[e.jsx(t,{variant:"h6",sx:{mt:3,color:"#fff",mb:2},children:"Membership application complete! You may now enter the garden."}),e.jsx(R,{variant:"contained",color:"success",sx:{fontWeight:700,borderRadius:999,px:4,py:1,fontSize:18,boxShadow:"none",bgcolor:"rgba(124, 179, 66, 0.3)",border:"2px solid rgba(124, 179, 66, 0.6)",backdropFilter:"blur(10px)",color:"#fff",textTransform:"none","&:hover":{bgcolor:"rgba(124, 179, 66, 0.5)",border:"2px solid rgba(124, 179, 66, 0.8)"}},onClick:()=>A&&A(),children:"Continue"})]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{variant:"contained",color:"success",sx:{fontWeight:700,borderRadius:999,px:4,py:1,fontSize:18,boxShadow:"none",bgcolor:"rgba(124, 179, 66, 0.3)",border:"2px solid rgba(124, 179, 66, 0.6)",backdropFilter:"blur(10px)",color:"#fff",textTransform:"none",mb:2,"&:hover":{bgcolor:"rgba(124, 179, 66, 0.5)",border:"2px solid rgba(124, 179, 66, 0.8)"}},onClick:ee,disabled:I||!v||!_,children:I?e.jsx(ie,{size:24,color:"inherit"}):"Apply for Membership"}),e.jsx(R,{variant:"text",sx:{fontWeight:600,color:"#fff",textTransform:"none",bgcolor:"rgba(124, 179, 66, 0.15)",backdropFilter:"blur(10px)","&:hover":{bgcolor:"rgba(124, 179, 66, 0.25)"}},onClick:()=>A&&A(),children:"Skip for now (Browse only)"})]})]})})}function ct({onBack:A,strainSlug:v}){const[w,_]=n.useState([]),[E,I]=n.useState(!1),[j,x]=n.useState(null),[c,D]=n.useState(null),[g,ee]=n.useState(10),[l,$]=n.useState("idle"),H=n.useRef(10),Y=n.useCallback(async(s,m,k)=>{I(!0),x(null);try{let h=`${U}/api/dispensaries-live?lat=${s}&lng=${m}&radius=${k}&limit=100`;v&&(h+=`&strain=${v}`),console.log("[DispensaryFinder] Calling API:",h);const F=await fetch(h);if(!F.ok){const Q=await F.text();console.error("[DispensaryFinder] API error:",F.status,Q),console.error("[DispensaryFinder] API URL:",h),console.error("[DispensaryFinder] API_BASE:",U);let J=`Search failed: ${F.status}`;throw F.status===404?J="Dispensary search endpoint not found. The backend server may not be running.":F.status===500&&(J="Server error during search. This may be a temporary issue - please try again."),new Error(J)}const u=await F.json();console.log("[DispensaryFinder] API response:",u);let q=[];if(Array.isArray(u)?q=u:u&&typeof u=="object"&&(q=u.results||u.dispensaries||[]),console.log("[DispensaryFinder] Found dispensaries:",q.length),console.log("[DispensaryFinder] Response structure:",{isArray:Array.isArray(u),hasResults:!!u.results,resultsLength:q.length,total:u.total,sources:u.sources}),!Array.isArray(q)||q.length===0){console.warn("[DispensaryFinder] No dispensaries found in response");const Q=u?.total||0;x(Q===0?`No dispensaries found within ${k} miles. Try increasing the search radius.`:"No dispensaries found. The search may have returned no results for this area."),_([])}else x(null),_(q)}catch(h){console.error("[DispensaryFinder] Search failed:",h);const F=h?.message||"Failed to find dispensaries. Please check your connection and try again.";x(F),_([])}finally{I(!1)}},[v]),K=n.useCallback(async()=>{try{$("detecting"),x(null),console.log("[DispensaryFinder] Requesting location permission...");let s=null;if(window.Capacitor&&window.Capacitor.Plugins&&window.Capacitor.Plugins.Geolocation)try{const{Geolocation:m}=window.Capacitor.Plugins;console.log("[DispensaryFinder] Using Capacitor Geolocation plugin...");const k=await Promise.race([m.getCurrentPosition({timeout:15e3,enableHighAccuracy:!1,maximumAge:3e5}),new Promise((h,F)=>{setTimeout(()=>F(new Error("TIMEOUT")),15e3)})]);console.log("[DispensaryFinder] Location obtained via Capacitor:",k),s={lat:k.coords.latitude,lng:k.coords.longitude}}catch(m){if(console.warn("[DispensaryFinder] Capacitor Geolocation failed, trying browser API:",m),m.message==="TIMEOUT")throw{code:3,message:"Location request timed out after 15 seconds"}}if(!s&&navigator.geolocation){console.log("[DispensaryFinder] Using browser geolocation API...");const m=setTimeout(()=>{console.warn("[DispensaryFinder] Geolocation timeout exceeded (15s)")},15e3);try{const k=await Promise.race([new Promise((h,F)=>{navigator.geolocation.getCurrentPosition(u=>{clearTimeout(m),h(u)},u=>{clearTimeout(m),F(u)},{enableHighAccuracy:!1,timeout:15e3,maximumAge:3e5})}),new Promise((h,F)=>{setTimeout(()=>{clearTimeout(m),F(new Error("TIMEOUT"))},15e3)})]);s={lat:k.coords.latitude,lng:k.coords.longitude},console.log("[DispensaryFinder] Location obtained via browser API:",s)}catch(k){throw clearTimeout(m),k.message==="TIMEOUT"?{code:3,message:"Location request timed out after 15 seconds"}:k}}if(!s){$("unsupported"),x("Geolocation is not supported. Please search manually.");return}D(s),$("success"),x(null),await Y(s.lat,s.lng,H.current)}catch(s){console.error("[DispensaryFinder] Geolocation error",s),s.code===1?($("denied"),x('Location permission denied. Please enable location access in Settings â†’ StrainSpotter â†’ Location, then tap "Find Dispensaries" below.')):s.code===2?($("unavailable"),x("Location is unavailable. Please check that location services are enabled on your device.")):s.code===3?($("timeout"),x('Location request timed out. Please tap "Find Dispensaries" to retry.')):($("error"),x(`Unable to get your location: ${s.message||"Unknown error"}. Please tap "Find Dispensaries" to retry.`))}},[Y]);n.useEffect(()=>{if(!c&&l==="idle"){console.log("[DispensaryFinder] Auto-requesting location on mount...");const s=setTimeout(()=>{K()},100);return()=>clearTimeout(s)}},[]);const ge=(s,m)=>{ee(m),c&&Y(c.lat,c.lng,m)},p=()=>{c&&Y(c.lat,c.lng,g)},ve=s=>{if(s.place_id){window.open(`https://www.google.com/maps/place/?q=place_id:${s.place_id}`,"_blank");return}const m=s.name||s.business_name||s.legal_name||s.title,k=[];m&&k.push(m),s.address&&k.push(s.address),s.formatted_address&&k.push(s.formatted_address);const h=[s.city,s.state].filter(Boolean).join(", ").trim();if(h&&k.push(h),s.postal_code&&k.push(s.postal_code),!s.address&&!s.city&&!s.state&&s.latitude!==void 0&&s.longitude!==void 0&&k.push(`${s.latitude}, ${s.longitude}`),k.length>0){const F=encodeURIComponent(k.join(", "));window.open(`https://www.google.com/maps/search/?api=1&query=${F}`,"_blank");return}s.latitude!==void 0&&s.longitude!==void 0&&window.open(`https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(`${s.latitude},${s.longitude}`)}`,"_blank")},S=(s,m)=>{window.open(`https://www.google.com/maps/dir/?api=1&destination=${s},${m}`,"_blank")};return e.jsxs(a,{sx:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden",background:"none"},children:[e.jsx(nt,{title:"Dispensary Finder",onBack:A}),e.jsxs(a,{sx:{flex:1,minHeight:0,overflowY:"auto",WebkitOverflowScrolling:"touch",px:2,pb:2,pt:1},children:[!c&&l!=="detecting"&&l!=="success"&&!j&&e.jsx(V,{sx:{p:4,mb:2,background:"rgba(255,255,255,0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(124, 179, 66, 0.3)",borderRadius:2,textAlign:"center"},children:e.jsxs(W,{spacing:3,alignItems:"center",children:[e.jsx(ye,{sx:{fontSize:64,color:"#7cb342"}}),e.jsxs(a,{children:[e.jsx(t,{variant:"h6",sx:{color:"#fff",mb:1,fontWeight:700},children:"Find Nearby Dispensaries"}),e.jsx(t,{variant:"body2",sx:{color:"rgba(255,255,255,0.7)"},children:"We need your location to find dispensaries near you"})]}),e.jsx(R,{variant:"contained",size:"large",startIcon:e.jsx(ye,{}),onClick:K,disabled:l==="detecting",sx:{bgcolor:"#7cb342",color:"#fff",fontWeight:700,px:4,py:1.5,fontSize:"1.1rem","&:hover":{bgcolor:"#689f38"},"&:disabled":{bgcolor:"rgba(124, 179, 66, 0.5)"}},children:l==="detecting"?"Requesting Location...":"Find Dispensaries"})]})}),l==="detecting"&&!j&&e.jsx(a,{sx:{display:"flex",justifyContent:"center",py:4},children:e.jsxs(W,{spacing:2,alignItems:"center",children:[e.jsx(ie,{sx:{color:"#7cb342"}}),e.jsx(t,{variant:"body2",sx:{color:"#e0e0e0"},children:"Getting your locationâ€¦"})]})}),j&&l!=="success"&&e.jsxs(V,{sx:{p:3,mb:2,background:"rgba(255,255,255,0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(124, 179, 66, 0.3)",borderRadius:2},children:[e.jsx(Z,{severity:"warning",sx:{mb:2,bgcolor:"rgba(255, 193, 7, 0.15)",color:"#fff",border:"1px solid rgba(255, 193, 7, 0.4)"},children:j}),e.jsx(R,{variant:"contained",fullWidth:!0,startIcon:e.jsx(ye,{}),onClick:()=>{x(null),D(null),_([]),K()},disabled:l==="detecting",sx:{bgcolor:"#7cb342","&:hover":{bgcolor:"#689f38"},"&:disabled":{bgcolor:"rgba(124, 179, 66, 0.5)"}},children:l==="detecting"?"Requesting...":"Find Dispensaries"})]}),c&&l==="success"&&e.jsx(V,{sx:{p:2,mb:2,background:"rgba(255,255,255,0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(124, 179, 66, 0.3)",borderRadius:2},children:e.jsxs(W,{spacing:2,children:[e.jsxs(a,{children:[e.jsxs(t,{variant:"body2",sx:{color:"#fff",mb:1},children:["Search Radius: ",g," miles"]}),e.jsx($r,{value:g,onChange:ge,min:1,max:100,step:1,marks:[{value:1,label:"1mi"},{value:25,label:"25mi"},{value:50,label:"50mi"},{value:100,label:"100mi"}],sx:{color:"#7cb342","& .MuiSlider-markLabel":{color:"#fff",fontSize:"0.75rem"}}})]}),e.jsx(R,{variant:"contained",onClick:p,disabled:E,sx:{bgcolor:"#7cb342","&:hover":{bgcolor:"#689f38"}},children:E?"Searching...":"Update Search"})]})}),j&&e.jsx(Z,{severity:"error",sx:{mb:2},children:j}),E&&e.jsx(a,{sx:{display:"flex",justifyContent:"center",py:8},children:e.jsx(ie,{sx:{color:"#7cb342"}})}),!E&&w.length===0&&e.jsxs(V,{sx:{p:4,textAlign:"center",background:"rgba(255,255,255,0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(124, 179, 66, 0.3)",borderRadius:2},children:[e.jsx(t,{variant:"h6",sx:{color:"#fff",mb:2},children:"No dispensaries found"}),e.jsx(t,{variant:"body2",sx:{color:"#e0e0e0"},children:"Try increasing the search radius or check back later."})]}),!E&&w.length>0&&e.jsxs(a,{children:[e.jsxs(t,{variant:"body2",sx:{color:"#e0e0e0",mb:2},children:["Found ",w.length," dispensaries within ",g," miles"]}),e.jsx(W,{spacing:2,children:w.map(s=>e.jsx(Ur,{sx:{background:"rgba(255,255,255,0.1)",backdropFilter:"blur(20px)",border:"1px solid rgba(124, 179, 66, 0.3)",borderRadius:2},children:e.jsx(Lr,{onClick:()=>ve(s),children:e.jsxs(Br,{children:[e.jsxs(W,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",mb:2,children:[e.jsxs(a,{flex:1,children:[e.jsxs(W,{direction:"row",alignItems:"center",spacing:1,mb:1,children:[e.jsx(t,{variant:"h6",sx:{color:"#fff",fontWeight:600},children:s.name}),s.verified&&e.jsx(xe,{label:"Verified",size:"small",sx:{bgcolor:"#7cb342",color:"#fff",fontSize:"0.7rem",height:20}}),e.jsx(xe,{label:s.source,size:"small",sx:{bgcolor:"rgba(255,255,255,0.2)",color:"#fff",fontSize:"0.65rem",height:18}})]}),e.jsxs(W,{spacing:.5,children:[e.jsxs(W,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(ye,{sx:{fontSize:16,color:"#7cb342"}}),e.jsx(t,{variant:"body2",sx:{color:"#e0e0e0"},children:s.address||`${s.city}, ${s.state}`})]}),s.distance!==void 0&&e.jsxs(t,{variant:"body2",sx:{color:"#7cb342",fontWeight:600},children:["ðŸ“ ",s.distance.toFixed(1)," miles away"]}),s.rating>0&&e.jsxs(W,{direction:"row",alignItems:"center",spacing:.5,children:[e.jsx(Or,{sx:{fontSize:16,color:"#ffd600"}}),e.jsxs(t,{variant:"body2",sx:{color:"#fff"},children:[s.rating," (",s.review_count," reviews)"]})]}),s.open_now!==void 0&&e.jsx(xe,{label:s.open_now?"Open Now":"Closed",size:"small",sx:{bgcolor:s.open_now?"rgba(76, 175, 80, 0.3)":"rgba(244, 67, 54, 0.3)",color:"#fff",fontSize:"0.75rem",width:"fit-content"}})]})]}),e.jsxs(W,{spacing:1,children:[s.latitude&&s.longitude&&e.jsx(X,{size:"small",onClick:m=>{m.stopPropagation(),S(s.latitude,s.longitude)},sx:{color:"#7cb342"},title:"Get Directions",children:e.jsx(Nr,{})}),s.phone&&e.jsx(X,{size:"small",component:"a",href:`tel:${s.phone}`,onClick:m=>m.stopPropagation(),sx:{color:"#7cb342"},title:"Call",children:e.jsx(Gr,{})}),s.website&&e.jsx(X,{size:"small",component:"a",href:s.website,target:"_blank",onClick:m=>m.stopPropagation(),sx:{color:"#7cb342"},title:"Visit Website",children:e.jsx(Hr,{})})]})]}),s.description&&e.jsx(t,{variant:"body2",sx:{color:"#e0e0e0",mt:1},children:s.description})]})})},s.id))})]})]})]})}function dt({open:A,onClose:v,user:w}){const[_,E]=n.useState(""),[I,j]=n.useState(!1),[x,c]=n.useState(!1),[D,g]=n.useState(null),ee=async()=>{if(_.trim()){if(!w||!w.id){g("Please log in to submit feedback.");return}j(!0),g(null);try{const l=await fetch(`${U}/api/feedback/messages`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:_,user_id:w.id})});if(l.ok)c(!0),E(""),setTimeout(()=>{c(!1),v()},2e3);else{const $=await l.json();g($.error||"Failed to send feedback.")}}catch{g("Network error. Please try again.")}j(!1)}};return e.jsx(Yr,{open:A,onClose:v,children:e.jsxs(a,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:380,bgcolor:"rgba(255,255,255,0.15)",backdropFilter:"blur(12px)",border:"2px solid #4caf50",boxShadow:24,p:4,borderRadius:3},children:[e.jsx(t,{variant:"h6",sx:{mb:2,color:"black",fontWeight:700},children:"Send Feedback"}),!w||!w.id?e.jsxs(a,{children:[e.jsx(t,{sx:{mb:2,color:"black"},children:"Please log in to submit feedback. This helps us follow up with you if needed."}),e.jsx(R,{variant:"outlined",onClick:v,sx:{fontWeight:700,color:"black",borderColor:"#4caf50"},children:"Close"})]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{multiline:!0,minRows:3,maxRows:6,fullWidth:!0,placeholder:"Share your thoughts, suggestions, or issues...",value:_,onChange:l=>E(l.target.value),sx:{mb:2,background:"rgba(255,255,255,0.10)",borderRadius:2,input:{color:"black"}}}),D&&e.jsx(t,{color:"error",sx:{mb:1},children:D}),x&&e.jsx(t,{color:"success.main",sx:{mb:1},children:"Thank you for your feedback!"}),e.jsxs(W,{direction:"row",spacing:2,children:[e.jsx(R,{variant:"contained",onClick:ee,disabled:I||!_.trim(),sx:{fontWeight:700,background:"#4caf50",color:"black"},children:I?"Sendingâ€¦":"Send"}),e.jsx(R,{variant:"outlined",onClick:v,sx:{fontWeight:700,color:"black",borderColor:"#4caf50"},children:"Cancel"})]})]})]})})}function ut(){const{remainingScans:A,isUnlimited:v,loading:w}=lt(),{isFounder:_,founderUnlimitedEnabled:E}=tt(),{user:I,session:j}=st(),x=!I&&!j,c=!!(_&&E);let D=A??null;c?D=1/0:x&&(D=20);const g=c||x||(D??0)>0;return{isFounder:c,remainingScans:D,canScan:g,loading:w,isGuest:x}}const ht=({confidence:A})=>{if(A==null)return null;const v=A>1?A:A*100,w=Math.max(0,Math.min(100,Math.round(v)));let _="success";return w<50&&(_="warning"),w<25&&(_="error"),e.jsxs(Z,{severity:_,sx:{mt:2,bgcolor:"rgba(124,179,66,0.08)",border:"1px solid rgba(124,179,66,0.3)"},children:["AI confidence: ",w,"%"]})};function ft({onBack:A,onScanComplete:v}){const w=n.useRef(null),[_,E]=n.useState(!0),[I,j]=n.useState(!1),[x,c]=n.useState("idle"),[D,g]=n.useState(null),[ee,l]=n.useState(null),[$,H]=n.useState(""),[Y,K]=n.useState(""),[ge]=n.useState(null),[p,ve]=n.useState(null),[S]=n.useState(null),[s,m]=n.useState([]),[k,h]=n.useState(!1),[F,u]=n.useState(""),[q,Q]=n.useState(!1),[J,pr]=n.useState(0),[y,pe]=n.useState(null),[mr,le]=n.useState(!1),[Ge,ke]=n.useState("scanner"),[br,Ce]=n.useState(!1),[_e,He]=n.useState(""),[Re,Ye]=n.useState(""),[Ae,qe]=n.useState(""),[Te,Je]=n.useState(5),[We,Ve]=n.useState(!1),[Fe,Ie]=n.useState([]),[yr,Ke]=n.useState(!1),[jr,Qe]=n.useState(!1),[wr,Ze]=n.useState(!1),[C,Pe]=n.useState(null),[Sr,ce]=n.useState(!1),[z,de]=n.useState(null),[vr,Xe]=n.useState(!1),[kr,se]=n.useState(!1),[er,rr]=n.useState(""),Cr=[{credits:50,price:"$4.99"},{credits:200,price:"$9.99"},{credits:500,price:"$19.99"}],{isFounder:_r}=at(),{remainingScans:L,isFounder:me,isGuest:Rr}=ut(),Ar=(C?.user_metadata?.membership||C?.user_metadata?.tier||"").toString().toLowerCase(),ue=["club","full-access","pro","owner","admin","garden","member"].some(r=>Ar.includes(r)),Me=typeof we=="string"&&we.length>0&&we!==`${U}/api`,Tr=n.useCallback(async({base64:r,filename:i,contentType:d,userId:b})=>{if(!Me||!r)return null;try{const f={"Content-Type":"application/json"};Ne&&(f.Authorization=`Bearer ${Ne}`,f.apikey=Ne);const P=await fetch(`${we}/uploads`,{method:"POST",headers:f,body:JSON.stringify({filename:i,base64:r,contentType:d,user_id:b})});if(!P.ok){const B=await P.text().catch(()=>"");return console.warn("[ScanWizard] Edge upload failed:",P.status,B),null}const T=await P.json();if(T?.id)return T}catch(f){console.warn("[ScanWizard] Edge upload exception:",f)}return null},[Me]);n.useEffect(()=>{if(!Se)return;Se.auth.getSession().then(({data:{session:i}})=>{Pe(i?.user??null)});const{data:{subscription:r}}=Se.auth.onAuthStateChange((i,d)=>{Pe(d?.user??null)});return()=>r.unsubscribe()},[]);const he=n.useCallback(async()=>{if(!C){de(null);return}Xe(!0);try{const r=await fetch(`${U}/api/scans/credits?user_id=${C.id}`);if(r.ok){const i=await r.json();de(i)}else{const i=await r.json().catch(()=>({}));console.error("Failed to load credits",i),ue&&de(d=>d??{credits:999,membershipActive:!0,starterExpired:!1,trialDaysRemaining:null,monthlyBundle:999})}}catch(r){console.error("Credit summary error:",r),ue&&de(i=>i??{credits:999,membershipActive:!0,starterExpired:!1,trialDaysRemaining:null,monthlyBundle:999})}finally{Xe(!1)}},[C,ue]);n.useEffect(()=>{if(!C){de(null);return}he()},[C,he]),n.useEffect(()=>{p?.strain?.slug&&fetch(`${U}/api/reviews?strain_slug=${p.strain.slug}`).then(r=>r.json()).then(r=>{Ie(Array.isArray(r)?r:[])}).catch(()=>{Ie([])})},[p?.strain?.slug]);const De=()=>{if(!C){ce(!0);return}Ce(!0)},Wr=async()=>{if(!(!p?.strain?.slug||!C)){Ve(!0);try{let r=_e;Re.trim()&&(r+=`

Effects: ${Re}`),Ae.trim()&&(r+=`

Flavors: ${Ae}`);const i=await fetch(`${U}/api/reviews`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:C.id,strain_slug:p.strain.slug,rating:Te,comment:r})});if(i.ok){u("Thank you for your review! It helps the community learn about this strain."),h(!0),Ce(!1),He(""),Ye(""),qe(""),Je(5);const b=await(await fetch(`${U}/api/reviews?strain_slug=${p.strain.slug}`)).json();Ie(b||[])}else{const d=await i.json();throw new Error(d.error||"Failed to submit review")}}catch(r){u(r.message||"Failed to submit review. Please try again."),h(!0)}finally{Ve(!1)}}},tr=async r=>{try{const i=await r.json();return i.error||i.message||r.statusText||"Unexpected error"}catch{return r.statusText||"Unexpected error"}},Fr=n.useCallback((r,i)=>{if(!r){console.warn("[ScanWizard] handlePollSuccess called without scan object");return}const d={id:r.id||r.scanId||r.scan_id||i||null,status:r.status||"completed",created_at:r.created_at??r.createdAt??null,processed_at:r.processed_at??r.processedAt??null,image_url:r.image_url||r.imageUrl||r.result?.image_url||null,result:{...r.result||{},seedBank:r.result?.seedBank??r.result?.seed_bank??null,canonical_strain:r.result?.canonical_strain??r.result?.canonicalStrain??(r.canonical_strain_name?{name:r.canonical_strain_name,source:r.canonical_strain_source||null,confidence:r.canonical_match_confidence??null}:null),ai_summary:r.result?.ai_summary??r.result?.aiSummary??r.ai_summary??r.aiSummary??null,packaging_insights:r.result?.packaging_insights??r.result?.packagingInsights??r.packaging_insights??r.packagingInsights??null,label_insights:r.result?.label_insights??r.result?.labelInsights??r.label_insights??r.labelInsights??null,plant_health:r.result?.plant_health??r.result?.plantHealth??r.plant_health??r.plantHealth??null,grow_profile:r.result?.grow_profile??r.result?.growProfile??r.grow_profile??r.growProfile??null},...r};d.id||console.warn("[ScanWizard] Poll success but missing scan id",{scan:r,normalizedScan:d});const b=hr(d);b&&(d.normalizedResult=b),v&&typeof v=="function"?v(d):ke("result")},[v]),sr=async(r,i=0)=>{try{const f=await fetch(`${U}/api/scans/${r}`),P=await f.json().catch(()=>({}));if(!f.ok)throw new Error(P?.error||`Scan lookup failed (${f.status})`);const T=P?.scan||P;if(!T)throw new Error("Invalid scan response from server");const B=T?.status||T?.state||"unknown",o=T?.result,ze=!!(o&&(o.visualMatches&&(o.visualMatches.match||o.visualMatches.candidates?.length>0)||Array.isArray(o.matches)&&o.matches.length>0||o.match||o.labelInsights)),M=B==="done"||B==="complete"||B==="completed"||B==="success",N=B==="error"||B==="failed"||!!T?.error||!!T?.errorMessage,Ee=Math.min(70+i*2,95);l(Ee),g("matching"),H(`Searching our database of 35,000+ strainsâ€¦ (attempt ${i+1})`);const te=!!(o?.visualMatches?.match||o?.visualMatches?.candidates?.length>0),$e=!!o?.labelInsights,zr=!!(o?.matches?.length>0||o?.match),Er=!!(o?.canonical_strain?.name||T?.canonical_strain_name||o?.labelInsights?.strainName);if(M||ze||te||$e||zr||Er){g("finalizing"),l(95),H("Compiling your complete strain breakdownâ€¦"),le(!1),j(!1);const G=hr(T);G?(l(100),setTimeout(()=>{g(null),l(null),pe(G),c("Scan complete!"),G.topMatch&&ve({strain:{...G.topMatch.dbMeta,name:G.topMatch.name,type:G.topMatch.type,slug:G.topMatch.id},confidence:G.topMatch.confidence}),Fr(T,r)},800)):(g(null),l(null),j(!1),c("No strain match found yet. Try a clearer photo or different angle."),pe(null));return}if(N){le(!1),j(!1),g(null),l(null);const G=T?.error||T?.errorMessage||"Scan failed on the server.";c(G);return}if(i>=25){le(!1),j(!1),g(null),l(null),c("Scan is taking too long. Please try again with a clearer photo.");return}setTimeout(()=>{sr(r,i+1)},1e3)}catch(f){console.error("pollScanResult error",f),le(!1),g(null),l(null),c(String(f.message||f))}},or=async r=>{const i=r.target.files?.[0];if(!i){c("idle");return}r.target&&(r.target.value=""),j(!0),g("uploading"),l(10),c("Uploading image..."),H("Securely uploading your photo to our serversâ€¦"),K("");try{const d=new FileReader;d.onload=async()=>{try{const b=d.result.split(",")[1];let f=null;if(Me&&C){g("uploading"),l(30),H("Uploading image to Supabaseâ€¦"),c("Uploading image to Supabase...");const M=await Tr({base64:b,filename:i.name,contentType:i.type,userId:C.id});M?.id&&(f=M)}if(!f){g("uploading"),l(50),H("Uploading image to backendâ€¦"),c("Uploading image to backend...");const M=await fetch(`${U}/api/uploads`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filename:i.name,contentType:i.type,base64:b,user_id:C?.id||null})});if(!M.ok){const N=await tr(M);throw new Error(N||"Upload failed")}f=await M.json()}const P=f.id;g("processing"),l(60),H("Extracting text and visual featuresâ€¦"),c("Processing scan...");const T=await fetch(`${U}/api/scans/${P}/process`,{method:"POST",headers:{"Content-Type":"application/json"}});if(T.status===402)if(_r)console.warn("[ScanWizard] Founder account hit 402 - backend may not be recognizing founder status. Continuing anyway.");else{let M={};try{M=await T.json()}catch($e){console.warn("[ScanWizard] Could not parse credit error payload:",$e)}const N=M.tier||"free",Ee=M.needsUpgrade||!1;let te=M.message||"No scan credits remaining.";Ee?te="ðŸŽ¯ You've used all 10 free scans! Unlock StrainSpotter (20 scans) or join Monthly Member ($4.99/mo) for 200 scans/month. Top-up packs (50 â€¢ 200 â€¢ 500) are also available.":N==="member"||N==="monthly_member"?te="ðŸ“Š You've used all 200 scans this month! Add a top-up pack (50 â€¢ 200 â€¢ 500 scans) or wait for your next monthly refresh.":N==="premium"&&(te="ðŸš€ You've used the legacy premium allotment. Grab a top-up pack (50 â€¢ 200 â€¢ 500 scans) to keep scanning."),u(te),h(!0),rr(te),se(!0),c("Out of credits"),await he(),j(!1);return}if(!T.ok){const M=await tr(T);throw new Error(M||"Scan processing failed")}const B=await T.json();let o=B.scan||B;if(!o||!o.id){const M=await fetch(`${U}/api/scans/${P}`);if(M.ok){const N=await M.json();o=N.scan||N}else o={id:P,status:"processing"}}g("matching"),l(70),H("Searching our database of 35,000+ strainsâ€¦"),c("Scan started successfully!"),le(!0),j(!1),sr(P,0);const ze={id:o.id||o.scanId||o.scan_id||P||null,status:o.status||"processing",created_at:o.created_at??o.createdAt??null,processed_at:o.processed_at??o.processedAt??null,image_url:o.image_url??o.imageUrl??o.result?.image_url??null,result:{...o.result||{},seedBank:o.result?.seedBank??o.result?.seed_bank??null,canonical_strain:o.result?.canonical_strain??o.result?.canonicalStrain??(o.canonical_strain_name?{name:o.canonical_strain_name,source:o.canonical_strain_source||null,confidence:o.canonical_match_confidence??null}:null),ai_summary:o.result?.ai_summary??o.result?.aiSummary??o.ai_summary??o.aiSummary??null,packaging_insights:o.result?.packaging_insights??o.result?.packagingInsights??o.packaging_insights??o.packagingInsights??null,label_insights:o.result?.label_insights??o.result?.labelInsights??o.label_insights??o.labelInsights??null,plant_health:o.result?.plant_health??o.result?.plantHealth??o.plant_health??o.plantHealth??null,grow_profile:o.result?.grow_profile??o.result?.growProfile??o.grow_profile??o.growProfile??null},...o};v&&typeof v=="function"&&v(ze),await he()}catch(b){console.error("Scan error:",b),g(null),l(null);const f=b?.message||b?.toString()||"Failed to process scan. Please check your connection and try again.";c("error"),K(f),u(f),h(!0),j(!1)}},d.onerror=()=>{const b="Unable to read the selected file. Please try a different image.";c("error"),K(b),u(b),h(!0),j(!1)},d.readAsDataURL(i)}catch(d){console.error("Scan error:",d);const b=d?.message||d?.toString()||"Failed to start scan. Please check your connection and try again.";c("error"),K(b),u(b),h(!0),j(!1)}};n.useEffect(()=>{const r=setInterval(async()=>{try{const i=await fetch(`${U}/api/scans`);if(i.ok){const b=(await i.json()).scans||[],f=b.filter(P=>P.status==="complete");f.length>0&&(u(`Scan matched: ${f.map(P=>P.strain?.name||"Unknown").join(", ")}`),h(!0)),m(b)}}catch(i){console.error("Poll error:",i)}},3e4);return()=>clearInterval(r)},[]);const Ir=()=>{if(!p||!p.strain)return null;const{strain:r}=p;return e.jsxs(Ue,{open:q,onClose:()=>Q(!1),maxWidth:"md",fullWidth:!0,fullScreen:!0,PaperProps:{sx:{bgcolor:"transparent",m:0,maxHeight:"100vh"}},children:[e.jsxs(Le,{sx:{borderBottom:"1px solid rgba(124,179,66,0.3)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(t,{variant:"h6",children:[r.name," Details"]}),e.jsx(X,{onClick:()=>Q(!1),sx:{color:"#fff"},children:e.jsx(Be,{})})]}),e.jsxs(rt,{value:J,onChange:(i,d)=>pr(d),sx:{borderBottom:"1px solid rgba(124,179,66,0.2)"},children:[e.jsx(je,{label:"Overview",sx:{color:"#c8ff9e"}}),e.jsx(je,{label:"Dispensaries",sx:{color:"#c8ff9e"}}),e.jsx(je,{label:"Seeds",sx:{color:"#c8ff9e"}}),e.jsx(je,{label:"Care Guide",sx:{color:"#c8ff9e"}})]}),e.jsxs(Oe,{sx:{bgcolor:"rgba(0,0,0,0.95)"},children:[J===0&&e.jsxs(a,{children:[e.jsx(t,{variant:"subtitle1",fontWeight:700,children:"Overview"}),r.description&&e.jsx(t,{children:r.description})]}),J===1&&e.jsxs(a,{children:[e.jsx(t,{variant:"subtitle1",fontWeight:700,children:"Dispensaries"}),e.jsx(t,{children:"Nearby dispensaries feature coming soon."})]}),J===2&&e.jsxs(a,{children:[e.jsx(t,{variant:"subtitle1",fontWeight:700,children:"Seeds"}),e.jsx(t,{children:"Seed info feature coming soon."})]}),J===3&&e.jsxs(a,{children:[e.jsx(t,{variant:"subtitle1",fontWeight:700,children:"Care Guide"}),e.jsx(t,{children:"Care guide feature coming soon."})]})]})]})},O=typeof z?.membershipActive=="boolean"?!!(z.membershipActive||ue||typeof z.monthlyBundle=="number"&&z.monthlyBundle>0):ue,fe=typeof z?.credits=="number"?z.credits:null,nr=typeof z?.monthlyBundle=="number"?z.monthlyBundle:null,ar=z?.resetAt?new Date(z.resetAt):null,oe=z?.accessExpiresAt?new Date(z.accessExpiresAt):null,re=!!z?.starterExpired&&!O,Pr=typeof z?.trialDaysRemaining=="number"?z.trialDaysRemaining:oe?Math.max(0,Math.ceil((oe.getTime()-Date.now())/(1e3*60*60*24))):null,Mr=typeof fe=="number"&&fe<=5,be=!me&&!Rr&&(L??0)<=0,Dr=be?"Upgrade to keep scanning":"Scan",ir=(()=>{if(O||!oe)return null;if(re)return"Your starter access has ended. Join the Garden to keep scanning with full AI access.";const r=Pr??Math.ceil((oe.getTime()-Date.now())/(1e3*60*60*24));return r<=0?"Starter access ends today. Join the Garden to keep scanning with full AI access.":`Starter access ends in ${r} day${r===1?"":"s"}. Join the Garden or grab a top-up pack to keep scanning.`})(),lr=ar?ar.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):null,cr=oe?oe.toLocaleDateString(void 0,{month:"short",day:"numeric",year:"numeric"}):null;return yr?e.jsx(ot,{onBack:()=>Ke(!1)}):jr?e.jsx(ct,{onBack:()=>Qe(!1)}):Ge==="result"&&y?e.jsx(ur,{children:e.jsxs(a,{sx:{display:"flex",flexDirection:"column",height:"100vh",overflow:"hidden",bgcolor:"transparent"},children:[e.jsxs(a,{sx:{flexShrink:0,display:"flex",alignItems:"center",gap:1.5,p:2,borderBottom:"1px solid rgba(255,255,255,0.08)",bgcolor:"transparent",backdropFilter:"blur(10px)",zIndex:1},children:[e.jsx(X,{edge:"start",onClick:()=>{ke("scanner"),pe(null)},sx:{color:"#fff"},"aria-label":"Go back to scanner",children:e.jsx(dr,{})}),e.jsx(t,{variant:"h6",sx:{fontWeight:600,color:"#fff",flex:1},children:"Scan Result"})]}),e.jsx(a,{sx:{flex:1,minHeight:0,overflowY:"auto",WebkitOverflowScrolling:"touch",px:2,py:2},children:e.jsxs(qr,{maxWidth:"md",sx:{py:2},children:[(()=>{const r=!!y.isPackagedProduct,i=ne(y?.topMatch&&y.topMatch.name||y?.matchedName||y?.name),d=ne(y.labelInsights?.strainName),b=ne(y.aiSummary?.title||y.labelInsights?.aiSummary?.title),f=r?b||d||i||"Unknown product":i||d||"Unknown strain";return e.jsxs(t,{sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"},fontWeight:900,color:"#00e676",letterSpacing:{xs:.5,sm:1},mb:{xs:1,sm:1.5},textAlign:"center",textShadow:"0 2px 8px #388e3c",fontFamily:"Montserrat, Arial, sans-serif"},children:[fr({isPackagedProduct:y.isPackagedProduct||!1,category:y.labelInsights?.category,productType:y.labelInsights?.productType})," identified: ",f]})})(),e.jsx(xr,{result:y,isGuest:!C,onSaveMatch:()=>console.log("Save match"),onLogExperience:()=>De(),onReportMismatch:()=>{u("Thank you for reporting. We'll review this match."),h(!0)},onViewStrain:()=>Q(!0)}),S&&e.jsxs(a,{sx:{mb:{xs:2,sm:3},p:{xs:2,sm:3},bgcolor:"rgba(0, 0, 0, 0.4)",borderRadius:{xs:2,sm:3},border:`2px solid ${S.healthStatus.color}`,boxShadow:`0 0 20px ${S.healthStatus.color}40`,width:"100%",mt:2},children:[e.jsx(t,{variant:"h6",sx:{color:"#fff",fontWeight:700,mb:{xs:1.5,sm:2}},children:"Plant Analysis"}),e.jsxs(t,{variant:"body2",sx:{color:"#fff"},children:["Growth Stage: ",S.growthStage?.stage||"Unknown"]}),e.jsxs(t,{variant:"body2",sx:{color:"#fff",mt:1},children:["Health Status: ",S.healthStatus?.status||"Unknown"]})]}),e.jsx(a,{sx:{display:"flex",flexDirection:"column",gap:2,mt:3,width:"100%",maxWidth:"400px",mx:"auto"},children:e.jsx(R,{variant:"contained",fullWidth:!0,onClick:()=>{ke("scanner"),pe(null),w.current?.click()},sx:{py:2,fontSize:"1rem",fontWeight:700,borderRadius:"12px",background:"linear-gradient(135deg, #7CB342 0%, #9CCC65 100%)",textTransform:"none"},children:"ðŸ“· Scan Another"})})]})})]})}):e.jsx(ur,{children:_?e.jsxs(a,{sx:{height:"100dvh",display:"flex",flexDirection:"column",bgcolor:"#0a0f0a",color:"#fff",overflow:"hidden",position:"relative"},children:[e.jsxs(a,{sx:{flexShrink:0,pt:"calc(env(safe-area-inset-top) + 8px)",px:2,pb:1,display:"flex",alignItems:"center",gap:1.5},children:[e.jsx(X,{edge:"start",onClick:()=>A?A():window.history.back(),size:"small",sx:{borderRadius:2,border:"1px solid",borderColor:"divider",color:"#fff"},children:e.jsx(dr,{fontSize:"small"})}),e.jsxs(a,{sx:{flex:1},children:[e.jsx(t,{variant:"subtitle1",fontWeight:600,noWrap:!0,sx:{color:"#fff"},children:"StrainSpotter Scanner"}),e.jsx(t,{variant:"caption",sx:{color:"rgba(255,255,255,0.7)"},noWrap:!0,children:"Snap packaging or buds to decode everything"})]}),C&&e.jsx(R,{variant:"text",size:"small",onClick:async()=>{try{await Se.auth.signOut(),Pe(null),u("Logged out successfully"),h(!0),setTimeout(()=>{A?A():window.location.href="/"},1e3)}catch(r){console.error("Logout error:",r),u("Logout failed"),h(!0)}},sx:{color:"#fff",textTransform:"none"},children:"Logout"})]}),e.jsxs(a,{sx:{flex:1,minHeight:0,overflowY:"auto",WebkitOverflowScrolling:"touch",px:2,pb:2},children:[e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",gap:2,minHeight:"100%"},children:[e.jsx(a,{sx:{display:"flex",justifyContent:"center",mb:{xs:1,sm:2}},children:e.jsx(a,{sx:{width:{xs:50,sm:70},height:{xs:50,sm:70},borderRadius:"50%",background:"transparent",border:"2px solid rgba(124, 179, 66, 0.5)",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 0 30px rgba(124, 179, 66, 0.5)",overflow:"hidden"},children:e.jsx("img",{src:"/hero.png?v=13",alt:"StrainSpotter",style:{width:"100%",height:"100%",objectFit:"cover"}})})}),e.jsx(t,{variant:"h3",align:"center",sx:{fontWeight:900,letterSpacing:1,color:"#fff",mb:{xs:.5,sm:1},fontSize:{xs:"1.5rem",sm:"2.5rem"},textShadow:"0 2px 12px #388e3c, 0 0px 2px #000",filter:"drop-shadow(0 0 8px #00e676)",fontFamily:"Montserrat, Arial, sans-serif"},children:"Identify Your Cannabis Plant"}),e.jsxs(t,{align:"center",sx:{mt:{xs:1,sm:2},color:"#fff",fontSize:{xs:"0.875rem",sm:"1.375rem"},fontWeight:600,px:{xs:1,sm:0},textShadow:"0 1px 8px #388e3c",fontFamily:"Montserrat, Arial, sans-serif"},children:["Snap a photo of your cannabis and let our AI deliver the full strain breakdownâ€”",e.jsx("span",{style:{color:"#00e676",fontWeight:900},children:"no hype"}),", just ",e.jsx("span",{style:{color:"#ffd600",fontWeight:900},children:"next-gen science"}),"."]}),C&&e.jsxs(V,{sx:{mt:{xs:2,sm:4},mb:{xs:2,sm:3},p:{xs:2,sm:3},width:"100%",maxWidth:720,background:"rgba(0, 0, 0, 0.45)",borderRadius:{xs:2,sm:4},border:"1px solid rgba(124, 179, 66, 0.4)",color:"#e8f5e9"},children:[e.jsxs(a,{children:[e.jsx(t,{variant:"subtitle2",sx:{textTransform:"uppercase",letterSpacing:1,color:"#c8ff9e",fontSize:{xs:"0.7rem",sm:"0.875rem"}},children:"Scan Credits"}),e.jsxs(t,{variant:"h3",sx:{fontWeight:800,color:"#fff",display:"flex",alignItems:"baseline",gap:1,fontSize:{xs:"2rem",sm:"3rem"}},children:[vr?e.jsx(ie,{size:28,sx:{color:"#c8ff9e"}}):me||typeof L=="number"&&L===1/0?"Unlimited":typeof L=="number"?L:fe??"--",!me&&!(typeof L=="number"&&L===1/0)&&e.jsx(t,{component:"span",variant:"h6",sx:{color:"#c8ff9e",fontWeight:500,fontSize:{xs:"1rem",sm:"1.25rem"}},children:"left"})]}),e.jsx(t,{variant:"body2",sx:{color:"#d0ffd6",maxWidth:420,fontSize:{xs:"0.75rem",sm:"0.875rem"}},children:O?"Membership perks active â€” we auto-refresh your bundle every month so you never lose your streak.":"Starter bundle includes 20 scans. After 3 days you'll need a membership or a top-up pack to keep scanning."}),O&&lr&&e.jsxs(t,{variant:"caption",sx:{display:"block",mt:1,color:"#b2fab4",fontSize:{xs:"0.65rem",sm:"0.75rem"}},children:["Next monthly reset: ",lr]}),!O&&cr&&e.jsxs(t,{variant:"caption",sx:{display:"block",mt:1,color:"#ffcc80",fontSize:{xs:"0.65rem",sm:"0.75rem"}},children:["Starter access expires: ",cr]})]}),!O&&ir&&e.jsx(Z,{severity:re?"error":"info",sx:{mt:2,bgcolor:re?"rgba(244, 67, 54, 0.2)":"rgba(124, 179, 66, 0.18)",color:"#fff","& .MuiAlert-icon":{color:re?"#ffccbc":"#c8ff9e"}},children:ir}),O&&nr&&e.jsxs(Z,{severity:"success",sx:{mt:2,bgcolor:"rgba(76, 175, 80, 0.18)",color:"#e8f5e9","& .MuiAlert-icon":{color:"#c8ff9e"}},children:["Your membership includes a ",nr,"-scan bundle each month. Weâ€™ll keep it topped up automatically."]}),!O&&Mr&&!re&&e.jsxs(Z,{severity:"warning",sx:{mt:2,bgcolor:"rgba(255, 193, 7, 0.18)",color:"#fff","& .MuiAlert-icon":{color:"#ffe082"}},children:["Only ",fe," scan",fe===1?"":"s"," left. Add a top-up pack or join the Garden to keep results flowing."]}),!O&&re&&e.jsx(Z,{severity:"error",sx:{mt:2,bgcolor:"rgba(244, 67, 54, 0.25)",color:"#fff","& .MuiAlert-icon":{color:"#ffccbc"}},children:"Starter access has ended. Join the Garden membership or redeem a top-up pack within the app stores to continue scanning."})]}),(I||mr||D)&&e.jsx(a,{sx:{mt:4,mb:4},children:e.jsx(it,{phase:D,message:$||x,progress:ee,error:Y||null})}),Y&&!I&&e.jsx(t,{variant:"body2",color:"error",sx:{mt:2,textAlign:"center",px:2},children:Y}),x&&x!=="idle"&&!I&&!Y&&e.jsx(t,{align:"center",sx:{mt:{xs:1,sm:2},color:"#388e3c",fontWeight:700,fontSize:{xs:"0.875rem",sm:"1rem"}},children:x})]}),y&&Ge==="scanner"&&e.jsxs(a,{sx:{mt:{xs:2,sm:4},width:"100%",maxWidth:600},children:[(()=>{const r=!!y.isPackagedProduct,i=ne(y?.topMatch&&y.topMatch.name||y?.matchedName||y?.name),d=ne(y.labelInsights?.strainName),b=ne(y.aiSummary?.title||y.labelInsights?.aiSummary?.title);let f=null;return r?f=b||d||i||"Unknown product":f=i||d||"Unknown strain",e.jsxs(t,{sx:{fontSize:{xs:"1.25rem",sm:"1.5rem"},fontWeight:900,color:"#00e676",letterSpacing:{xs:.5,sm:1},mb:{xs:1,sm:1.5},textAlign:"center",textShadow:"0 2px 8px #388e3c",fontFamily:"Montserrat, Arial, sans-serif"},children:[fr({isPackagedProduct:y.isPackagedProduct||!1,category:y.labelInsights?.category,productType:y.labelInsights?.productType})," identified: ",f]})})(),e.jsx(xr,{result:y,isGuest:!C,onSaveMatch:()=>{console.log("Save match")},onLogExperience:()=>{De()},onReportMismatch:()=>{u("Thank you for reporting. We'll review this match."),h(!0)},onViewStrain:()=>{Q(!0)}}),S&&e.jsxs(a,{sx:{mb:{xs:2,sm:3},p:{xs:2,sm:3},bgcolor:"rgba(0, 0, 0, 0.4)",borderRadius:{xs:2,sm:3},border:`2px solid ${S.healthStatus.color}`,boxShadow:`0 0 20px ${S.healthStatus.color}40`,width:"100%"},children:[e.jsx(t,{variant:"h6",sx:{color:"#fff",fontWeight:700,mb:{xs:1.5,sm:2},display:"flex",alignItems:"center",gap:1,fontSize:{xs:"1rem",sm:"1.25rem"}},children:e.jsxs(W,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(a,{component:"img",src:"/hero.png?v=13",alt:"",sx:{width:18,height:18,filter:"drop-shadow(0 0 4px rgba(124, 179, 66, 0.6))"}}),e.jsx("span",{children:"Plant Analysis"})]})}),e.jsxs(a,{sx:{mb:2},children:[e.jsx(t,{variant:"body2",sx:{color:"#9CCC65",fontWeight:700,mb:.5},children:"Growth Stage:"}),e.jsxs(t,{variant:"body1",sx:{color:"#fff",fontSize:18,fontWeight:600},children:[S.growthStage.icon," ",S.growthStage.stage]}),e.jsx(t,{variant:"body2",sx:{color:"#b0b0b0",mt:.5},children:S.growthStage.description}),e.jsxs(t,{variant:"caption",sx:{color:"#808080"},children:["Timeframe: ",S.growthStage.timeframe]})]}),e.jsxs(a,{sx:{mb:2},children:[e.jsx(t,{variant:"body2",sx:{color:"#9CCC65",fontWeight:700,mb:.5},children:"Health Status:"}),e.jsx(xe,{label:S.healthStatus.status,sx:{bgcolor:`${S.healthStatus.color}30`,color:S.healthStatus.color,fontWeight:700,border:`2px solid ${S.healthStatus.color}`,fontSize:16,px:2,py:2.5}}),S.healthStatus.issues.length>0&&e.jsx(a,{sx:{mt:1},children:S.healthStatus.issues.map((r,i)=>e.jsxs(t,{variant:"body2",sx:{color:"#fff",mt:.5},children:["â€¢ ",r]},i))})]}),S.recommendations&&S.recommendations.length>0&&e.jsxs(a,{children:[e.jsx(t,{variant:"body2",sx:{color:"#9CCC65",fontWeight:700,mb:1},children:"Care Recommendations:"}),e.jsx(W,{spacing:.5,children:S.recommendations.map((r,i)=>e.jsx(t,{variant:"body2",sx:{color:"#fff",fontSize:14},children:r},i))})]}),e.jsx(ht,{confidence:S.confidence})]}),e.jsxs(a,{sx:{mt:3,mb:3,p:3,bgcolor:"rgba(0, 0, 0, 0.3)",borderRadius:3,border:"2px solid rgba(124, 179, 66, 0.3)",width:"100%"},children:[e.jsx(t,{variant:"h6",sx:{color:"#00e676",fontWeight:700,mb:2},children:"ðŸ“ Share Your Experience"}),br?e.jsxs(a,{sx:{display:"flex",flexDirection:"column",gap:2},children:[e.jsx(ae,{label:"Your Review",multiline:!0,rows:4,value:_e,onChange:r=>He(r.target.value),placeholder:"Share your experience with this strain...",fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{color:"#fff","& fieldset":{borderColor:"rgba(124, 179, 66, 0.5)"},"&:hover fieldset":{borderColor:"rgba(124, 179, 66, 0.7)"},"&.Mui-focused fieldset":{borderColor:"rgba(124, 179, 66, 0.9)"}},"& .MuiInputLabel-root":{color:"#fff"}}}),e.jsx(ae,{label:"Effects (comma-separated)",value:Re,onChange:r=>Ye(r.target.value),placeholder:"e.g., relaxed, happy, euphoric",fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{color:"#fff","& fieldset":{borderColor:"rgba(124, 179, 66, 0.5)"},"&:hover fieldset":{borderColor:"rgba(124, 179, 66, 0.7)"},"&.Mui-focused fieldset":{borderColor:"rgba(124, 179, 66, 0.9)"}},"& .MuiInputLabel-root":{color:"#fff"}}}),e.jsx(ae,{label:"Flavors (comma-separated)",value:Ae,onChange:r=>qe(r.target.value),placeholder:"e.g., berry, sweet, earthy",fullWidth:!0,sx:{"& .MuiOutlinedInput-root":{color:"#fff","& fieldset":{borderColor:"rgba(124, 179, 66, 0.5)"},"&:hover fieldset":{borderColor:"rgba(124, 179, 66, 0.7)"},"&.Mui-focused fieldset":{borderColor:"rgba(124, 179, 66, 0.9)"}},"& .MuiInputLabel-root":{color:"#fff"}}}),e.jsxs(a,{children:[e.jsxs(t,{variant:"body2",color:"#fff",sx:{mb:1},children:["Rating: ",Te,"/10"]}),e.jsx("input",{type:"range",min:"1",max:"10",value:Te,onChange:r=>Je(parseInt(r.target.value)),style:{width:"100%"}})]}),e.jsxs(W,{direction:"row",spacing:2,children:[e.jsx(R,{variant:"contained",disabled:We||!_e.trim(),sx:{fontWeight:700,borderRadius:999,px:4,py:1,fontSize:16,boxShadow:"none",bgcolor:"rgba(124, 179, 66, 0.3)",border:"2px solid rgba(124, 179, 66, 0.6)",backdropFilter:"blur(10px)",color:"#fff",textTransform:"none","&:hover":{bgcolor:"rgba(124, 179, 66, 0.5)",border:"2px solid rgba(124, 179, 66, 0.8)"}},onClick:Wr,children:We?e.jsx(ie,{size:20,color:"inherit"}):"Submit Review"}),e.jsx(R,{variant:"outlined",disabled:We,sx:{fontWeight:700,borderRadius:999,px:4,py:1,fontSize:16,boxShadow:"none",bgcolor:"rgba(124, 179, 66, 0.2)",border:"2px solid rgba(124, 179, 66, 0.5)",backdropFilter:"blur(10px)",color:"#fff",textTransform:"none","&:hover":{bgcolor:"rgba(124, 179, 66, 0.3)",border:"2px solid rgba(124, 179, 66, 0.7)"}},onClick:()=>Ce(!1),children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(t,{variant:"body2",color:"#fff",sx:{mb:2},children:["Have you tried ",p.strain?.name,"? Help the community by sharing your experience with effects, flavors, and overall rating."]}),e.jsxs(R,{variant:"contained",sx:{fontWeight:700,borderRadius:999,px:4,py:1,fontSize:16,boxShadow:"none",bgcolor:"rgba(124, 179, 66, 0.3)",border:"2px solid rgba(124, 179, 66, 0.6)",backdropFilter:"blur(10px)",color:"#fff",textTransform:"none","&:hover":{bgcolor:"rgba(124, 179, 66, 0.5)",border:"2px solid rgba(124, 179, 66, 0.8)"}},onClick:De,children:["âœï¸ Leave a Review ",!C&&"(Members Only)"]})]})]}),Fe.length>0&&e.jsxs(a,{sx:{mt:3,mb:3,p:3,bgcolor:"rgba(0, 0, 0, 0.3)",borderRadius:3,border:"2px solid rgba(124, 179, 66, 0.3)",width:"100%"},children:[e.jsxs(t,{variant:"h6",sx:{color:"#00e676",fontWeight:700,mb:2},children:["ðŸ’¬ Community Reviews (",Fe.length,")"]}),e.jsx(W,{spacing:2,children:Fe.map((r,i)=>e.jsxs(a,{sx:{p:2,bgcolor:"rgba(255, 255, 255, 0.05)",borderRadius:2,borderLeft:"3px solid rgba(124, 179, 66, 0.6)"},children:[e.jsxs(t,{variant:"body2",sx:{color:"#ffd600",fontWeight:700,mb:1},children:[r.users?.username||r.user||"Anonymous"," â€¢ ",new Date(r.created_at||r.date).toLocaleDateString()]}),e.jsx(t,{variant:"body2",sx:{color:"#fff",whiteSpace:"pre-line"},children:r.comment||r.review}),r.rating&&e.jsxs(t,{variant:"body2",sx:{color:"#00e676",mt:1},children:["â­ Rating: ",r.rating,"/5"]})]},i))})]}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column",gap:2,mt:3,width:"100%",maxWidth:"400px",mx:"auto",px:2},children:[e.jsx(R,{variant:"contained",fullWidth:!0,onClick:()=>{if(C)Ke(!0);else{const r=p.strain?.slug||p.strain?.name;window.open(`https://www.seedsman.com/en/search?q=${encodeURIComponent(r)}`,"_blank")}},sx:{py:2,fontSize:"1rem",fontWeight:700,borderRadius:"12px",background:"linear-gradient(135deg, #7CB342 0%, #9CCC65 100%)",boxShadow:"0 4px 12px rgba(124, 179, 66, 0.3)",textTransform:"none",transition:"all 0.2s ease","&:active":{transform:"scale(0.98)",boxShadow:"0 2px 8px rgba(124, 179, 66, 0.4)"}},children:"ðŸŒ± Buy Seeds"}),e.jsx(R,{variant:"outlined",fullWidth:!0,onClick:()=>{if(C)Qe(!0);else{const r=p.strain?.name||p.strain?.slug;window.open(`https://www.google.com/search?q=${encodeURIComponent(r+" cannabis dispensary near me")}`,"_blank")}},sx:{py:2,fontSize:"1rem",fontWeight:700,borderRadius:"12px",border:"2px solid rgba(124, 179, 66, 0.6)",color:"#9CCC65",textTransform:"none",transition:"all 0.2s ease","&:active":{transform:"scale(0.98)",background:"rgba(124, 179, 66, 0.15)",border:"2px solid rgba(124, 179, 66, 0.8)"}},children:"ðŸª Find Dispensaries"})]}),e.jsxs(a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:{xs:1.5,sm:2},mt:{xs:2,sm:3},background:"rgba(30,30,30,0.25)",backdropFilter:"blur(16px) saturate(180%)",borderRadius:{xs:3,sm:6},px:{xs:2,sm:4},py:{xs:2,sm:3},boxShadow:"0 4px 32px 0 rgba(0,0,0,0.12)",border:"1px solid rgba(255,255,255,0.18)",width:"100%"},children:[e.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},ref:w,onChange:or}),e.jsxs(R,{variant:"contained",color:"success",fullWidth:!0,sx:{fontWeight:700,borderRadius:999,px:{xs:3,sm:5},py:{xs:1.25,sm:1.5},fontSize:{xs:"0.95rem",sm:"1.125rem"},boxShadow:"none",bgcolor:"rgba(124, 179, 66, 0.3)",border:"2px solid rgba(124, 179, 66, 0.6)",backdropFilter:"blur(10px)",color:"#fff",textTransform:"none",maxWidth:{xs:"100%",sm:"400px"},"&:hover":{bgcolor:"rgba(124, 179, 66, 0.5)",border:"2px solid rgba(124, 179, 66, 0.8)"},"&:active":{transform:"scale(0.98)"}},onClick:()=>w.current?.click(),children:[e.jsx("span",{role:"img","aria-label":"camera",style:{marginRight:8},children:"ðŸ“·"}),"Scan Another Strain"]}),I&&e.jsx(ie,{color:"success",sx:{mt:{xs:1,sm:2}}}),x&&!I&&e.jsx(t,{align:"center",sx:{mt:{xs:1,sm:2},color:"#00e676",fontWeight:700,fontSize:{xs:"0.875rem",sm:"1rem"}},children:x})]}),p.strain?.labTestResults&&p.strain.labTestResults.length>0&&e.jsxs(a,{sx:{mb:2,width:"100%"},children:[e.jsx(t,{variant:"subtitle2",color:"#fff",gutterBottom:!0,children:"Lab Test Results:"}),e.jsx(W,{spacing:1,children:p.strain.labTestResults.map((r,i)=>e.jsx(a,{sx:{bgcolor:"rgba(255,255,255,0.10)",backdropFilter:"blur(6px)",borderRadius:2,p:1},children:e.jsxs(t,{variant:"body2",color:"#fff",children:[r.date&&e.jsxs("span",{children:[e.jsx("strong",{children:"Date:"})," ",r.date," "]}),r.lab&&e.jsxs("span",{children:[e.jsx("strong",{children:"Lab:"})," ",r.lab," "]}),r.testType&&e.jsxs("span",{children:[e.jsx("strong",{children:"Type:"})," ",r.testType," "]}),typeof r.thc=="number"&&e.jsxs("span",{children:[e.jsx("strong",{children:"THC:"})," ",r.thc,"% "]}),typeof r.cbd=="number"&&e.jsxs("span",{children:[e.jsx("strong",{children:"CBD:"})," ",r.cbd,"% "]}),r.comment&&e.jsxs("span",{children:[e.jsx("strong",{children:"Note:"})," ",r.comment]})]})},i))})]}),p.strain?.growTips&&e.jsxs(a,{sx:{mb:2,width:"100%"},children:[e.jsx(t,{variant:"subtitle2",color:"#fff",gutterBottom:!0,children:"Grow Tips:"}),e.jsx(t,{variant:"body2",color:"#fff",children:p.strain.growTips})]}),p.strain?.seedVendors&&p.strain.seedVendors.length>0&&e.jsxs(a,{sx:{mb:2,width:"100%"},children:[e.jsx(t,{variant:"subtitle2",color:"#fff",gutterBottom:!0,children:"Seed Vendors:"}),e.jsx(W,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:p.strain.seedVendors.map((r,i)=>e.jsx(xe,{label:r.name,size:"small",variant:"outlined",component:"a",href:r.url,clickable:!0,sx:{borderColor:"#7CB342",color:"#9CCC65","&:hover":{borderColor:"#9CCC65",bgcolor:"rgba(124, 179, 66, 0.1)"}}},i))})]}),p.strain?.breeder&&e.jsxs(a,{sx:{mb:2,width:"100%"},children:[e.jsx(t,{variant:"subtitle2",color:"#fff",gutterBottom:!0,children:"Breeder:"}),e.jsx(t,{variant:"body2",color:"#fff",children:p.strain.breeder})]})]}),C&&e.jsx(a,{sx:{mt:4},children:e.jsxs(a,{sx:{borderRadius:6,p:3,boxShadow:"none",border:"none"},children:[e.jsx(t,{variant:"h6",sx:{mb:2,color:"#fff"},children:"Your Scan History"}),e.jsx(W,{spacing:2,children:s&&Array.isArray(s)&&s.length===0?e.jsx(t,{sx:{color:"#e0e0e0"},children:"No scans yet."}):(s||[]).map((r,i)=>e.jsxs(V,{sx:{p:2,borderRadius:2,bgcolor:"rgba(255,255,255,0.1)",backdropFilter:"blur(10px)",border:"1px solid rgba(124, 179, 66, 0.3)",boxShadow:"none"},children:[e.jsx(t,{variant:"body2",sx:{color:"#fff"},children:r?.status==="pending"?"Pending scan...":`Matched: ${r?.strain?.name||"Unknown"}`}),e.jsx(t,{variant:"caption",sx:{color:"#e0e0e0"},children:r?.created})]},r?.id||i))})]})}),ge&&!p&&e.jsxs(a,{sx:{mt:3},children:[e.jsx(t,{variant:"subtitle1",fontWeight:700,children:"Raw Scan Result"}),e.jsx(a,{sx:{mt:1,p:2,borderRadius:4},children:e.jsx("pre",{style:{textAlign:"left",fontSize:14},children:JSON.stringify(ge,null,2)})})]}),Ir(),e.jsxs(Ue,{open:kr,onClose:()=>se(!1),maxWidth:"sm",fullWidth:!0,fullScreen:!0,PaperProps:{sx:{bgcolor:"#111",m:0,maxHeight:"100vh"}},children:[e.jsxs(Le,{sx:{bgcolor:"#111",color:"#c8ff9e",fontWeight:700,borderBottom:"1px solid rgba(124,179,66,0.3)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(t,{variant:"h6",children:"Keep Your Scans Going"}),e.jsx(X,{onClick:()=>se(!1),sx:{color:"#c8ff9e"},children:e.jsx(Be,{})})]}),e.jsxs(Oe,{sx:{bgcolor:"#111",color:"#fff",pt:3},children:[er&&e.jsx(Jr,{sx:{color:"#e0ffe3",mb:2},children:er}),!O&&e.jsxs(V,{sx:{p:2,mb:3,background:"linear-gradient(135deg, rgba(124,179,66,0.25), rgba(0,0,0,0.65))",border:"1px solid rgba(124,179,66,0.4)",borderRadius:3},children:[e.jsx(t,{variant:"h6",sx:{fontWeight:700,color:"#c8ff9e",mb:1},children:"Garden Membership Â· $7.99 / month"}),e.jsx(t,{variant:"body2",sx:{color:"#e8f5e9",mb:1},children:"Unlimited monthly scan bundles, private grower community access, and priority support. Perfect if you scan often or want the full Garden experience."}),e.jsx(R,{variant:"contained",color:"success",fullWidth:!0,sx:{mt:1,borderRadius:999,textTransform:"none",fontWeight:700},onClick:()=>{se(!1),ce(!0)},children:"Join the Garden"})]}),e.jsx(Vr,{sx:{borderColor:"rgba(255,255,255,0.12)",mb:3}}),e.jsx(t,{variant:"subtitle1",sx:{fontWeight:700,color:"#c8ff9e",mb:1},children:"Quick Top-Up Packs (3-day access window)"}),e.jsx(t,{variant:"body2",sx:{color:"#e8f5e9",mb:2},children:"Redeem on iOS or Android. Each pack reloads your credits instantly and keeps your non-member access alive for 3 more days."}),e.jsx(W,{spacing:2,sx:{mb:3},children:Cr.map(r=>e.jsxs(V,{sx:{p:2,borderRadius:3,background:"rgba(255,255,255,0.06)",border:"1px solid rgba(124,179,66,0.3)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(a,{children:[e.jsxs(t,{variant:"subtitle1",sx:{color:"#fff",fontWeight:700},children:[r.credits," scans"]}),e.jsx(t,{variant:"caption",sx:{color:"#c8ff9e"},children:"Expires 3 days after activation"})]}),e.jsx(R,{variant:"outlined",sx:{borderColor:"rgba(200,255,158,0.7)",color:"#c8ff9e",textTransform:"none",borderRadius:999,fontWeight:600,"&:hover":{borderColor:"rgba(200,255,158,1)"}},onClick:()=>{u("Checkout for scan packs happens through Apple App Store or Google Play. Launch the mobile app to complete your purchase."),h(!0)},children:r.price})]},r.credits))}),e.jsx(Z,{severity:"info",sx:{bgcolor:"rgba(124, 179, 66, 0.2)",color:"#e8f5e9","& .MuiAlert-icon":{color:"#c8ff9e"}},children:"Purchases finalize inside the Apple App Store or Google Play app. Once the store confirms your order we auto-sync credits to your account. Need a hand? Email support@strainspotter.com."})]}),e.jsx(Kr,{sx:{bgcolor:"#111",borderTop:"1px solid rgba(255,255,255,0.12)"},children:e.jsx(R,{onClick:()=>se(!1),sx:{color:"#c8ff9e",textTransform:"none"},children:"Close"})})]}),e.jsxs(Ue,{open:Sr,onClose:()=>ce(!1),maxWidth:"sm",fullWidth:!0,fullScreen:!0,PaperProps:{sx:{bgcolor:"rgba(0, 0, 0, 0.95)",m:0,maxHeight:"100vh"}},children:[e.jsxs(Le,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",bgcolor:"rgba(0, 0, 0, 0.9)",color:"#00e676",borderBottom:"1px solid rgba(124,179,66,0.3)"},children:[e.jsx(t,{variant:"h6",sx:{fontWeight:700},children:e.jsxs(W,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(a,{component:"img",src:"/hero.png?v=13",alt:"",sx:{width:18,height:18,filter:"drop-shadow(0 0 4px rgba(124, 179, 66, 0.6))"}}),e.jsx("span",{children:"Garden Membership Access"})]})}),e.jsx(X,{onClick:()=>ce(!1),sx:{color:"#fff"},children:e.jsx(Be,{})})]}),e.jsxs(Oe,{sx:{bgcolor:"rgba(0, 0, 0, 0.9)",color:"#fff",pt:3},children:[e.jsx(t,{variant:"body1",sx:{mb:3},children:"Membership unlocks unlimited scan refills, in-depth strain tools, and the private grower community. Join the StrainSpotter Garden to:"}),e.jsxs(a,{component:"ul",sx:{pl:3,mb:3},children:[e.jsx("li",{children:"Access unlimited AI scan bundles every month"}),e.jsx("li",{children:"Unlock reviews, ratings, and premium strain breakdowns"}),e.jsx("li",{children:"Connect with certified growers in members-only chats"}),e.jsx("li",{children:"Get early access to new cultivation features"}),e.jsx("li",{children:"Support the AI lab that keeps strain matching sharp"})]}),e.jsx(gr,{onSuccess:()=>{ce(!1),u("Welcome to the Garden! Membership perks are now active."),h(!0),he()}})]})]}),e.jsx(Qr,{open:k,autoHideDuration:4e3,onClose:()=>h(!1),message:F,anchorOrigin:{vertical:"top",horizontal:"center"}}),e.jsx(Zr,{title:"Send Feedback",placement:"left",children:e.jsx(Xr,{color:"primary",onClick:()=>Ze(!0),sx:{position:"fixed",bottom:24,right:24,zIndex:1e3,background:"linear-gradient(135deg, #7CB342 0%, #9CCC65 100%)",boxShadow:"0 8px 30px rgba(124, 179, 66, 0.4)","&:hover":{background:"linear-gradient(135deg, #9CCC65 0%, #7CB342 100%)",boxShadow:"0 12px 40px rgba(124, 179, 66, 0.6)",transform:"scale(1.05)"}},children:e.jsx(et,{})})}),e.jsx(dt,{open:wr,onClose:()=>Ze(!1),user:C})]}),e.jsxs(a,{sx:{position:"sticky",bottom:0,zIndex:20,background:"linear-gradient(to top, rgba(3,10,3,0.95), rgba(3,10,3,0.4))",pt:1,pb:"calc(env(safe-area-inset-bottom) + 8px)",px:2,flexShrink:0},children:[e.jsx("input",{type:"file",accept:"image/*",style:{display:"none"},ref:w,onChange:or}),e.jsx(R,{fullWidth:!0,variant:"contained",size:"large",onClick:()=>{if(be){const r=re?"Your starter access window has ended. Join the Garden membership or purchase a top-up pack within 3 days to keep scanning.":"You are out of scan credits. Join the Garden or purchase a top-up pack to continue scanning.";u(r),h(!0),rr(r),se(!0);return}w.current?.click()},disabled:be||I,sx:{borderRadius:999,py:1.4,fontWeight:600,textTransform:"none",mb:1},children:I?"Scanningâ€¦":Dr}),!be&&!me&&typeof L=="number"&&L>0&&L!==1/0&&e.jsxs(t,{variant:"body2",sx:{mt:1,textAlign:"center",color:"#c8ff9e",opacity:.9},children:[L," scan",L===1?"":"s"," remaining"]})]})]}):e.jsx(gr,{onSuccess:()=>E(!0)})})}const wt=Object.freeze(Object.defineProperty({__proto__:null,default:ft},Symbol.toStringTag,{value:"Module"}));export{ct as D,dt as F,ft as S,wt as a};
